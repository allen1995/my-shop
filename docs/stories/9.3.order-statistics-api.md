# Story 9.3: 订单统计API

## Status
Ready for Review

## Story
As a user,
I want to see my order statistics,
so that I can understand my purchase activity.

## Acceptance Criteria
1. 后端提供 `/api/user/statistics` GET接口
2. 返回订单总数、待支付数、待收货数等
3. 返回作品总数、收藏数等
4. 接口响应时间小于100ms

## Tasks / Subtasks
- [x] Task 1: 实现订单统计查询 (AC: 2)
- [x] Task 2: 实现作品统计查询 (AC: 3)
- [x] Task 3: 创建统计接口 (AC: 1)
- [x] Task 4: 使用count方法确保性能 (AC: 4)

## Dev Notes
### Relevant Source Tree
- backend/src/main/java/com/myshop/controller/UserController.java
- backend/src/main/java/com/myshop/repository/OrderRepository.java
- backend/src/main/java/com/myshop/repository/WorkRepository.java

### Testing
- Test file location: backend/src/test/java/com/myshop/controller/UserControllerTest.java
- Test standards: 单元测试覆盖统计接口，验证返回数据准确性

## Dev Agent Record
### Agent Model Used
Auto (Cursor AI)

### Debug Log References
- None yet

### Completion Notes
- Task 1: 实现了订单统计查询，包括订单总数、待支付数、待收货数、已完成数
- Task 2: 实现了作品统计查询，包括作品总数、收藏数
- Task 3: 创建了GET `/api/user/statistics`接口，返回订单和作品的统计数据
- Task 4: 使用Repository的count方法进行统计，确保查询性能，响应时间应小于100ms

### File List
- backend/src/main/java/com/myshop/controller/UserController.java (修改：添加统计接口)
- backend/src/main/java/com/myshop/repository/OrderRepository.java (修改：添加count方法)
- backend/src/main/java/com/myshop/repository/WorkRepository.java (修改：添加count方法)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-14 | 1.0 | Story created | Dev Agent |
| 2024-12-14 | 1.1 | Story 9.3 implementation completed | Dev Agent |

## QA Results

### Gate Status

Gate: CONCERNS → docs/qa/gates/9.3-order-statistics-api.yml

