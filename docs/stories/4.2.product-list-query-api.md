# Story 4.2: 商品列表查询API

## Status

Draft

## Story

**As a** user,
**I want** to view available bag products,
**so that** I can choose which bag to apply my design to.

## Acceptance Criteria

1. 后端提供 `/api/products` GET接口
2. 接口返回所有可用的包包商品
3. 返回商品的基本信息（名称、类型、价格、图片等）
4. 接口响应时间小于100ms

## Tasks / Subtasks

- [ ] Task 1: 创建ProductController (AC: 1, 2, 3)
  - [ ] 创建ProductController
  - [ ] 实现GET /api/products接口
  - [ ] 查询所有商品
  - [ ] 返回商品列表
- [ ] Task 2: 创建响应DTO (AC: 3)
  - [ ] 创建ProductResponse DTO
  - [ ] 包含商品基本信息字段
- [ ] Task 3: 优化查询性能 (AC: 4)
  - [ ] 确保Repository查询使用索引
  - [ ] 验证响应时间小于100ms
- [ ] Task 4: 创建单元测试 (AC: 1, 2, 3)
  - [ ] 创建ProductControllerTest
  - [ ] 测试查询商品列表
  - [ ] 测试响应时间

## Dev Notes

### Previous Story Insights

依赖Story 4.1（商品实体和数据库设计）完成，确保Product实体类和ProductRepository已创建。

### Data Models

使用Story 4.1创建的Product实体类。

**响应DTO：**
- ProductListResponse: { products: Product[] }

[Source: docs/fullstack-architecture.md#Product（商品）]

### API Specifications

**GET /api/products**
- 描述：获取商品列表
- 无需认证（公开接口）
- 响应：`{ products: Product[] }`

[Source: docs/fullstack-architecture.md#API Specification]

### File Locations

**后端文件位置：**
```
backend/src/main/java/com/myshop/
├── controller/
│   └── ProductController.java        # 商品控制器
└── dto/
    └── ProductListResponse.java      # 商品列表响应DTO
```

[Source: docs/fullstack-architecture.md#Repository Structure]

### Technical Constraints

- **性能**: 响应时间小于100ms
- **公开接口**: 无需认证，所有用户可访问

[Source: docs/fullstack-architecture.md#Tech Stack]

### Testing Requirements

- 使用JUnit 5和MockMvc进行Controller测试
- 测试文件位置：`backend/src/test/java/com/myshop/controller/ProductControllerTest.java`
- 测试正常查询
- 性能测试（响应时间）

[Source: docs/fullstack-architecture.md#Tech Stack]

## Testing

### Test File Location

测试文件应创建在：`backend/src/test/java/com/myshop/controller/ProductControllerTest.java`

### Test Standards

- 使用JUnit 5和Spring Boot Test
- 使用MockMvc测试REST接口
- 验证响应时间

### Test Scenarios

1. **查询商品列表测试**
   - 创建多个商品
   - 查询商品列表
   - 验证返回所有商品

2. **性能测试**
   - 验证响应时间小于100ms

### Success Criteria

- 商品列表查询接口能够正常返回商品
- 响应时间满足要求

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-15 | 1.0 | 初始故事创建 | Scrum Master |

## Dev Agent Record

### Agent Model Used

_To be filled by Dev Agent_

### Debug Log References

_To be filled by Dev Agent_

### Completion Notes List

_To be filled by Dev Agent_

### File List

_To be filled by Dev Agent_

## QA Results

_To be filled by QA Agent_

