# Story 9.2: 收货地址实体和API

## Status
Ready for Review

## Story
As a developer,
I want to create the Address entity and APIs,
so that users can manage shipping addresses.

## Acceptance Criteria
1. Address实体类已创建
2. 地址CRUD API已实现
3. 支持设置默认地址
4. 地址验证完善

## Tasks / Subtasks
- [x] Task 1: 创建Address实体类 (AC: 1)
- [x] Task 2: 创建AddressRepository (AC: 1)
- [x] Task 3: 实现地址CRUD API (AC: 2)
- [x] Task 4: 实现设置默认地址功能 (AC: 3)
- [x] Task 5: 添加地址验证 (AC: 4)

## Dev Notes
### Relevant Source Tree
- backend/src/main/java/com/myshop/entity/Address.java
- backend/src/main/java/com/myshop/controller/AddressController.java
- backend/src/main/java/com/myshop/repository/AddressRepository.java

### Testing
- Test file location: backend/src/test/java/com/myshop/controller/AddressControllerTest.java
- Test standards: 单元测试覆盖地址CRUD接口，验证默认地址设置

## Dev Agent Record
### Agent Model Used
Auto (Cursor AI)

### Debug Log References
- None yet

### Completion Notes
- Task 1: 创建了Address实体类，包含收货人信息、省市区、详细地址、默认地址标识等字段
- Task 2: 创建了AddressRepository，包含按用户查询、设置默认地址等方法
- Task 3: 实现了地址CRUD API：POST创建、GET查询列表和详情、PUT更新、DELETE删除
- Task 4: 实现了设置默认地址功能，支持通过PUT接口设置，自动清除其他默认地址
- Task 5: 添加了完善的地址验证：收货人姓名、手机号格式、省市区、详细地址等字段验证

### File List
- backend/src/main/java/com/myshop/entity/Address.java (新建：地址实体)
- backend/src/main/java/com/myshop/repository/AddressRepository.java (新建：地址仓库)
- backend/src/main/java/com/myshop/controller/AddressController.java (新建：地址管理控制器)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-14 | 1.0 | Story created | Dev Agent |
| 2024-12-14 | 1.1 | Story 9.2 implementation completed | Dev Agent |

## QA Results

### Gate Status

Gate: CONCERNS → docs/qa/gates/9.2-address-entity-api.yml

