# Story 4.4: 前端印花预览页面

## Status

Draft

## Story

**As a** user,
**I want** to preview how my work looks on a bag,
**so that** I can decide if I want to purchase it.

## Acceptance Criteria

1. 印花预览页面已创建
2. 显示包包基础图片
3. 支持选择包包款式（下拉选择或卡片选择）
4. 支持选择颜色和尺寸
5. 将作品图片叠加到包包图片上预览
6. 支持调整印花位置（拖拽或点击位置）
7. 实时预览效果
8. 页面UI美观，符合设计规范

## Tasks / Subtasks

- [ ] Task 1: 创建预览页面 (AC: 1)
  - [ ] 创建pages/preview/preview.vue
  - [ ] 设计页面布局
- [ ] Task 2: 实现商品选择 (AC: 3)
  - [ ] 加载商品列表（调用/api/products接口）
  - [ ] 实现商品选择器（下拉或卡片）
  - [ ] 选择商品后加载商品详情
- [ ] Task 3: 实现颜色和尺寸选择 (AC: 4)
  - [ ] 显示商品可用的颜色选项
  - [ ] 显示商品可用的尺寸选项
  - [ ] 实现颜色和尺寸选择器
- [ ] Task 4: 实现图片预览 (AC: 2, 5, 7)
  - [ ] 显示包包基础图片
  - [ ] 显示作品图片
  - [ ] 使用Canvas或CSS实现图片叠加
  - [ ] 实时更新预览效果
- [ ] Task 5: 实现位置调整 (AC: 6)
  - [ ] 实现拖拽调整位置（使用touch事件）
  - [ ] 或实现点击位置调整
  - [ ] 保存位置信息
- [ ] Task 6: 优化UI和用户体验 (AC: 8)
  - [ ] 优化页面布局和样式
  - [ ] 添加加载状态
  - [ ] 确保符合设计规范
- [ ] Task 7: 创建API封装 (AC: 2, 3)
  - [ ] 在api/product.js中创建getProducts和getProductDetail方法
  - [ ] 封装商品列表和详情查询接口

## Dev Notes

### Previous Story Insights

依赖Story 4.2（商品列表查询API）和Story 4.3（商品详情查询API）完成，确保后端接口可用。同时依赖Story 3.7（前端作品详情页面）完成，能够从作品详情页跳转过来。

### Data Models

**商品接口：**
```typescript
interface Product {
  id: number;
  name: string;
  type: string;
  description?: string;
  basePrice: number;
  colors: string[];
  sizes: string[];
  imageUrl: string;
}
```

**页面参数：**
- workId: number - 作品ID（可选）
- imageUrl: string - 作品图片URL

[Source: docs/fullstack-architecture.md#Product（商品）]

### API Specifications

**GET /api/products**
- 响应：`{ products: Product[] }`

**GET /api/products/{productId}**
- 响应：`{ product: Product }`

前端需要：
- 加载商品列表供选择
- 加载选中商品的详情（颜色、尺寸）

[Source: docs/fullstack-architecture.md#API Specification]

### File Locations

**前端文件位置：**
```
frontend/
├── pages/
│   └── preview/
│       └── preview.vue               # 印花预览页面
└── api/
    └── product.js                    # 商品API封装（如未创建）
```

[Source: docs/fullstack-architecture.md#Repository Structure]

### Technical Constraints

- **图片叠加**: 使用Canvas 2D或CSS实现（小程序环境推荐Canvas 2D）
- **位置调整**: 使用touch事件实现拖拽
- **实时预览**: 使用watch监听数据变化，实时更新预览

[Source: docs/fullstack-architecture.md#Tech Stack]

### Testing Requirements

前端测试暂不实施，主要进行手动验证：
- 验证页面显示
- 验证商品选择
- 验证预览效果
- 验证位置调整

[Source: docs/fullstack-architecture.md#Tech Stack]

## Testing

### Test File Location

前端测试暂不实施，后续添加。

### Test Standards

当前阶段主要进行手动验证：
- 在微信开发者工具中测试页面功能
- 验证商品选择和预览功能

### Test Scenarios

1. **页面显示测试**
   - 进入预览页面
   - 验证商品列表加载
   - 验证包包图片显示

2. **商品选择测试**
   - 选择不同商品
   - 验证商品详情加载
   - 验证颜色和尺寸选项更新

3. **预览效果测试**
   - 选择商品、颜色、尺寸
   - 验证作品图片叠加到包包图片上
   - 验证预览效果实时更新

4. **位置调整测试**
   - 拖拽或点击调整位置
   - 验证位置更新
   - 验证预览效果更新

### Success Criteria

- 印花预览页面能够正常显示
- 商品选择功能正常
- 预览效果正确
- 位置调整功能正常
- 页面UI美观

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-15 | 1.0 | 初始故事创建 | Scrum Master |

## Dev Agent Record

### Agent Model Used

_To be filled by Dev Agent_

### Debug Log References

_To be filled by Dev Agent_

### Completion Notes List

_To be filled by Dev Agent_

### File List

_To be filled by Dev Agent_

## QA Results

_To be filled by QA Agent_

