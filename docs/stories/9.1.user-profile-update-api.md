# Story 9.1: 用户信息更新API

## Status
Ready for Review

## Story
As a user,
I want to update my profile information,
so that my account reflects my current details.

## Acceptance Criteria
1. 后端提供 `/api/user/profile` PUT接口
2. 支持更新昵称、头像、手机号等
3. 参数验证完善
4. 返回更新后的用户信息

## Tasks / Subtasks
- [x] Task 1: 检查User实体字段 (AC: 2)
- [x] Task 2: 实现用户信息更新接口 (AC: 1)
- [x] Task 3: 添加参数验证 (AC: 3)
- [x] Task 4: 确保返回更新后的用户信息 (AC: 4)

## Dev Notes
### Relevant Source Tree
- backend/src/main/java/com/myshop/entity/User.java
- backend/src/main/java/com/myshop/controller/AuthController.java
- backend/src/main/java/com/myshop/repository/UserRepository.java

### Testing
- Test file location: backend/src/test/java/com/myshop/controller/AuthControllerTest.java
- Test standards: 单元测试覆盖用户信息更新接口，验证参数验证

## Dev Agent Record
### Agent Model Used
Auto (Cursor AI)

### Debug Log References
- None yet

### Completion Notes
- Task 1: User实体已有nickName、avatarUrl、phone字段，满足需求
- Task 2: 实现了PUT `/api/user/profile`接口和GET `/api/user/profile`接口
- Task 3: 添加了参数验证：昵称长度、头像URL长度、手机号格式验证
- Task 4: 接口返回更新后的完整用户信息

### File List
- backend/src/main/java/com/myshop/controller/UserController.java (新建：用户信息管理控制器)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-14 | 1.0 | Story created | Dev Agent |
| 2024-12-14 | 1.1 | Story 9.1 implementation completed | Dev Agent |

## QA Results

### Gate Status

Gate: CONCERNS → docs/qa/gates/9.1-user-profile-update-api.yml

