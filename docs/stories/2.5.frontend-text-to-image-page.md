# Story 2.5: 前端文生图页面

## Status

Draft

## Story

**As a** user,
**I want** to input a text prompt and set parameters on the frontend,
**so that** I can generate images with my desired style.

## Acceptance Criteria

1. 文生图页面已创建
2. 提示词输入框已实现，支持多行输入
3. 参数设置面板已实现（尺寸、风格选择）
4. 尺寸选项：正方形、横版、竖版
5. 风格选项：写实、插画、抽象、水彩等
6. 生成按钮已实现，点击后调用后端API
7. 参数验证已实现，提示词不能为空
8. 页面UI美观，符合设计规范

## Tasks / Subtasks

- [ ] Task 1: 创建文生图页面 (AC: 1)
  - [ ] 创建pages/generate/text-to-image.vue
  - [ ] 设计页面布局（使用uView UI组件）
- [ ] Task 2: 实现提示词输入 (AC: 2, 7)
  - [ ] 添加多行文本输入框
  - [ ] 实现字符计数（可选）
  - [ ] 添加必填验证
  - [ ] 添加占位符提示
- [ ] Task 3: 实现参数设置面板 (AC: 3, 4, 5)
  - [ ] 添加尺寸选择器（单选）
  - [ ] 尺寸选项：正方形(1:1)、横版(16:9)、竖版(9:16)
  - [ ] 添加风格选择器（单选或下拉）
  - [ ] 风格选项：写实、插画、抽象、水彩、卡通等
  - [ ] 使用uView UI组件（u-radio-group、u-select等）
- [ ] Task 4: 实现生成功能 (AC: 6, 7)
  - [ ] 创建生成按钮
  - [ ] 实现参数验证（提示词不能为空）
  - [ ] 调用后端/api/image-generation/text-to-image接口
  - [ ] 获取taskId
  - [ ] 跳转到生成进度页（传递taskId）
- [ ] Task 5: 创建API封装 (AC: 6)
  - [ ] 在api/imageGeneration.js中创建textToImage方法
  - [ ] 封装文生图接口调用
- [ ] Task 6: 优化UI和用户体验 (AC: 8)
  - [ ] 添加加载状态
  - [ ] 添加错误提示
  - [ ] 优化页面布局和样式
  - [ ] 确保符合设计规范

## Dev Notes

### Previous Story Insights

依赖Story 2.3（文生图API接口实现）完成，确保后端接口可用。同时依赖Story 1.2（前端项目初始化）完成，确保项目结构和网络请求封装已就绪。

### Data Models

**文生图请求：**
```typescript
interface TextToImageRequest {
  prompt: string;
  parameters: {
    size: string;  // "1:1" | "16:9" | "9:16"
    style: string; // "realistic" | "illustration" | "abstract" | "watercolor" | "cartoon"
  };
}
```

**文生图响应：**
```typescript
interface TextToImageResponse {
  taskId: number;
}
```

[Source: docs/fullstack-architecture.md#API Specification]

### API Specifications

**POST /api/image-generation/text-to-image**
- 请求体：`{ prompt: string, parameters: { size: string, style: string } }`
- 响应：`{ taskId: number }`

前端需要：
- 收集用户输入的prompt和parameters
- 调用后端接口
- 获取taskId后跳转到生成进度页

[Source: docs/fullstack-architecture.md#API Specification]

### File Locations

**前端文件位置：**
```
frontend/
├── pages/
│   └── generate/
│       └── text-to-image.vue        # 文生图页面
└── api/
    └── imageGeneration.js           # 图片生成API封装（更新）
```

[Source: docs/fullstack-architecture.md#Repository Structure]

### Technical Constraints

- **UI组件**: 使用uView UI组件库
- **表单验证**: 使用uView UI的表单验证或自定义验证
- **导航**: 使用uni.navigateTo跳转到生成进度页
- **状态管理**: 可选使用Pinia存储生成参数

[Source: docs/fullstack-architecture.md#Tech Stack]

### Testing Requirements

前端测试暂不实施，主要进行手动验证：
- 验证页面显示
- 验证参数输入
- 验证生成功能
- 验证参数验证

[Source: docs/fullstack-architecture.md#Tech Stack]

## Testing

### Test File Location

前端测试暂不实施，后续添加。

### Test Standards

当前阶段主要进行手动验证：
- 在微信开发者工具中测试页面功能
- 验证参数输入和验证
- 验证生成功能

### Test Scenarios

1. **页面显示测试**
   - 验证页面能够正常显示
   - 验证所有UI组件正常

2. **参数输入测试**
   - 输入提示词
   - 选择尺寸和风格
   - 验证参数保存正确

3. **参数验证测试**
   - 不输入提示词，点击生成
   - 验证显示错误提示

4. **生成功能测试**
   - 输入完整参数，点击生成
   - 验证调用后端接口
   - 验证跳转到生成进度页

### Success Criteria

- 文生图页面能够正常显示
- 参数输入功能正常
- 参数验证正确
- 生成功能正常
- 页面UI美观

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-15 | 1.0 | 初始故事创建 | Scrum Master |

## Dev Agent Record

### Agent Model Used

_To be filled by Dev Agent_

### Debug Log References

_To be filled by Dev Agent_

### Completion Notes List

_To be filled by Dev Agent_

### File List

_To be filled by Dev Agent_

## QA Results

_To be filled by QA Agent_

