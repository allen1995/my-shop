# Test Design: Story 7.1

Date: 2024-12-16
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 12
- Unit tests: 4 (33%)
- Integration tests: 5 (42%)
- E2E tests: 3 (25%)
- Priority distribution: P0: 5, P1: 5, P2: 2

## Test Scenarios by Acceptance Criteria

### AC1: 作品实体添加category字段

#### Scenarios

| ID           | Level       | Priority | Test                      | Justification            |
| ------------ | ----------- | -------- | ------------------------- | ------------------------ |
| 7.1-UNIT-001 | Unit        | P1       | 验证Work实体category字段存在且类型正确 | 实体字段验证，纯逻辑检查 |
| 7.1-INT-001  | Integration | P1       | 验证category字段持久化到数据库 | 数据库操作验证 |

### AC2: 后端提供 `/api/works/{workId}/category` PUT接口更新分类

#### Scenarios

| ID           | Level       | Priority | Test                      | Justification            |
| ------------ | ----------- | -------- | ------------------------- | ------------------------ |
| 7.1-UNIT-002 | Unit        | P0       | 验证请求参数验证逻辑（category格式、长度） | 输入验证逻辑，纯函数测试 |
| 7.1-INT-001  | Integration | P0       | 验证PUT接口更新分类成功 | 接口与数据库交互验证 |
| 7.1-INT-002  | Integration | P0       | 验证PUT接口返回更新后的作品信息 | 接口响应验证 |
| 7.1-INT-003  | Integration | P1       | 验证PUT接口处理不存在的workId | 错误处理验证 |
| 7.1-INT-004  | Integration | P1       | 验证PUT接口处理未授权访问 | 安全验证 |

### AC3: 作品列表API支持按分类筛选

#### Scenarios

| ID           | Level       | Priority | Test                      | Justification            |
| ------------ | ----------- | -------- | ------------------------- | ------------------------ |
| 7.1-UNIT-003 | Unit        | P1       | 验证分类筛选查询逻辑 | 查询逻辑验证 |
| 7.1-INT-005  | Integration | P0       | 验证GET接口按category参数筛选作品 | 接口筛选功能验证 |
| 7.1-INT-006  | Integration | P2       | 验证GET接口支持空category参数（返回全部） | 边界条件验证 |
| 7.1-E2E-001  | E2E         | P1       | 验证用户通过分类筛选查看作品列表 | 用户旅程验证 |

### AC4: 前端作品集页面支持分类选择

#### Scenarios

| ID           | Level       | Priority | Test                      | Justification            |
| ------------ | ----------- | -------- | ------------------------- | ------------------------ |
| 7.1-E2E-002  | E2E         | P1       | 验证用户在前端选择分类后显示对应作品 | 完整用户交互流程 |
| 7.1-E2E-003  | E2E         | P2       | 验证分类选择UI交互（标签页切换） | UI交互验证 |

### AC5: 支持自定义分类名称

#### Scenarios

| ID           | Level       | Priority | Test                      | Justification            |
| ------------ | ----------- | -------- | ------------------------- | ------------------------ |
| 7.1-UNIT-004 | Unit        | P1       | 验证自定义分类名称验证逻辑（长度、字符限制） | 输入验证逻辑 |
| 7.1-E2E-004  | E2E         | P1       | 验证用户添加自定义分类并应用到作品 | 完整用户流程验证 |

## Risk Coverage

- 数据完整性风险：通过INT测试验证分类字段持久化
- 用户体验风险：通过E2E测试验证分类筛选流程
- 安全风险：通过INT测试验证未授权访问处理

## Recommended Execution Order

1. P0 Unit tests (fail fast)
   - 7.1-UNIT-002: 请求参数验证逻辑
2. P0 Integration tests
   - 7.1-INT-001: PUT接口更新分类
   - 7.1-INT-002: PUT接口返回验证
   - 7.1-INT-005: GET接口分类筛选
3. P0 E2E tests
   - (无P0 E2E测试)
4. P1 tests in order
   - 7.1-UNIT-001: 实体字段验证
   - 7.1-UNIT-003: 分类筛选查询逻辑
   - 7.1-INT-001: category字段持久化
   - 7.1-INT-003: 不存在的workId处理
   - 7.1-INT-004: 未授权访问处理
   - 7.1-E2E-001: 分类筛选用户旅程
   - 7.1-E2E-002: 前端分类选择
   - 7.1-UNIT-004: 自定义分类名称验证
   - 7.1-E2E-004: 自定义分类流程
5. P2+ as time permits
   - 7.1-INT-006: 空category参数处理
   - 7.1-E2E-003: 分类选择UI交互

## Coverage Gaps

无 - 所有验收标准都有测试覆盖

