# Test Design: Story 7.2

Date: 2024-12-16
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 15
- Unit tests: 5 (33%)
- Integration tests: 7 (47%)
- E2E tests: 3 (20%)
- Priority distribution: P0: 6, P1: 7, P2: 2

## Test Scenarios by Acceptance Criteria

### AC1: 作品实体支持多标签（tags字段为数组）

#### Scenarios

| ID           | Level       | Priority | Test                      | Justification            |
| ------------ | ----------- | -------- | ------------------------- | ------------------------ |
| 7.2-UNIT-001 | Unit        | P1       | 验证Work实体tags字段存在且支持数组格式 | 实体字段验证 |
| 7.2-INT-001  | Integration | P1       | 验证tags数组字段持久化到数据库 | 数据库操作验证 |

### AC2: 后端提供标签管理接口

#### Scenarios

| ID           | Level       | Priority | Test                      | Justification            |
| ------------ | ----------- | -------- | ------------------------- | ------------------------ |
| 7.2-UNIT-002 | Unit        | P0       | 验证标签更新请求参数验证（数组格式、标签长度） | 输入验证逻辑 |
| 7.2-INT-002  | Integration | P0       | 验证PUT接口更新标签列表成功 | 接口与数据库交互 |
| 7.2-INT-003  | Integration | P0       | 验证POST接口添加单个标签成功 | 接口功能验证 |
| 7.2-INT-004  | Integration | P0       | 验证DELETE接口删除标签成功 | 接口功能验证 |
| 7.2-INT-005  | Integration | P1       | 验证标签管理接口处理重复标签 | 业务逻辑验证 |
| 7.2-INT-006  | Integration | P1       | 验证标签管理接口处理不存在的workId | 错误处理验证 |
| 7.2-INT-007  | Integration | P1       | 验证标签管理接口处理未授权访问 | 安全验证 |

### AC3: 作品列表API支持按标签筛选

#### Scenarios

| ID           | Level       | Priority | Test                      | Justification            |
| ------------ | ----------- | -------- | ------------------------- | ------------------------ |
| 7.2-UNIT-003 | Unit        | P1       | 验证按标签筛选查询逻辑 | 查询逻辑验证 |
| 7.2-INT-008  | Integration | P0       | 验证GET接口按tag参数筛选作品 | 接口筛选功能验证 |
| 7.2-INT-009  | Integration | P2       | 验证GET接口支持多标签筛选 | 边界条件验证 |
| 7.2-E2E-001  | E2E         | P1       | 验证用户通过标签筛选查看作品列表 | 用户旅程验证 |

### AC4: 前端支持添加、编辑、删除标签

#### Scenarios

| ID           | Level       | Priority | Test                      | Justification            |
| ------------ | ----------- | -------- | ------------------------- | ------------------------ |
| 7.2-E2E-002  | E2E         | P1       | 验证用户在前端添加标签 | 完整用户交互流程 |
| 7.2-E2E-003  | E2E         | P1       | 验证用户在前端删除标签 | 完整用户交互流程 |
| 7.2-E2E-004  | E2E         | P2       | 验证标签编辑UI交互 | UI交互验证 |

### AC5: 标签自动补全功能（可选）

#### Scenarios

| ID           | Level       | Priority | Test                      | Justification            |
| ------------ | ----------- | -------- | ------------------------- | ------------------------ |
| 7.2-UNIT-004 | Unit        | P3       | 验证标签自动补全算法（如实现） | 可选功能，低优先级 |
| 7.2-E2E-005  | E2E         | P3       | 验证标签自动补全UI交互（如实现） | 可选功能，低优先级 |

## Risk Coverage

- 数据完整性风险：通过INT测试验证标签数组持久化
- 用户体验风险：通过E2E测试验证标签管理流程
- 安全风险：通过INT测试验证未授权访问处理
- 性能风险：通过INT测试验证多标签筛选性能

## Recommended Execution Order

1. P0 Unit tests (fail fast)
   - 7.2-UNIT-002: 标签更新请求参数验证
2. P0 Integration tests
   - 7.2-INT-002: PUT接口更新标签列表
   - 7.2-INT-003: POST接口添加标签
   - 7.2-INT-004: DELETE接口删除标签
   - 7.2-INT-008: GET接口按标签筛选
3. P0 E2E tests
   - (无P0 E2E测试)
4. P1 tests in order
   - 7.2-UNIT-001: 实体tags字段验证
   - 7.2-UNIT-003: 按标签筛选查询逻辑
   - 7.2-INT-001: tags数组字段持久化
   - 7.2-INT-005: 重复标签处理
   - 7.2-INT-006: 不存在的workId处理
   - 7.2-INT-007: 未授权访问处理
   - 7.2-E2E-001: 标签筛选用户旅程
   - 7.2-E2E-002: 前端添加标签
   - 7.2-E2E-003: 前端删除标签
5. P2+ as time permits
   - 7.2-INT-009: 多标签筛选
   - 7.2-E2E-004: 标签编辑UI交互
   - 7.2-UNIT-004: 标签自动补全算法（如实现）
   - 7.2-E2E-005: 标签自动补全UI（如实现）

## Coverage Gaps

无 - 所有验收标准都有测试覆盖（AC5为可选功能，已标记P3优先级）

