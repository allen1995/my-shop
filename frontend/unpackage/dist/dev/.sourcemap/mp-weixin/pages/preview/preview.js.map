{"version":3,"file":"preview.js","sources":["pages/preview/preview.vue","../../../software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcHJldmlldy9wcmV2aWV3LnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"preview-container\">\r\n    <!-- È¢ÑËßàÂõæÁâáÂ±ïÁ§∫Âå∫Âüü -->\r\n    <view class=\"preview-section\">\r\n      <!-- Êú™ÁîüÊàêÊó∂ÊòæÁ§∫ÂéüÂõæ -->\r\n      <view v-if=\"!previewUrl && !isGenerating\" class=\"preview-placeholder\">\r\n        <image \r\n          v-if=\"imageUrl\"\r\n          :src=\"imageUrl\" \r\n          class=\"placeholder-image\"\r\n          mode=\"aspectFit\"\r\n        />\r\n        <text class=\"placeholder-hint\">ÈÄâÊã©ÂïÜÂìÅÂêéÁîüÊàêÈ¢ÑËßà</text>\r\n      </view>\r\n      \r\n      <!-- ÁîüÊàê‰∏≠ÊòæÁ§∫Âä†ËΩΩ -->\r\n      <view v-if=\"isGenerating\" class=\"preview-loading\">\r\n        <view class=\"loading-spinner\"></view>\r\n        <text class=\"loading-text\">{{ loadingText }}</text>\r\n        <text class=\"loading-tip\">È¢ÑËÆ°ÈúÄË¶Å 10 Áßí</text>\r\n      </view>\r\n      \r\n      <!-- È¢ÑËßàÂõæÁâá -->\r\n      <view v-if=\"previewUrl && !isGenerating\" class=\"preview-result\">\r\n        <image \r\n          :src=\"previewUrl\" \r\n          class=\"preview-image\"\r\n          mode=\"aspectFit\"\r\n        />\r\n        <button \r\n          class=\"regenerate-btn\"\r\n          @click=\"handleRegenerate\"\r\n        >\r\n          <text class=\"btn-icon\">üîÑ</text>\r\n          <text>ÈáçÊñ∞ÁîüÊàê</text>\r\n        </button>\r\n      </view>\r\n      \r\n      <!-- ÈîôËØØÊèêÁ§∫ -->\r\n      <view v-if=\"errorMessage && !isGenerating\" class=\"error-message\">\r\n        <text class=\"error-icon\">‚ö†Ô∏è</text>\r\n        <text class=\"error-text\">{{ errorMessage }}</text>\r\n        <button class=\"retry-btn\" @click=\"handleRetry\">ÈáçËØï</button>\r\n      </view>\r\n    </view>\r\n    \r\n    <!-- ÂïÜÂìÅÈÄâÊã©Âå∫Âüü -->\r\n    <view class=\"product-section\">\r\n      <view class=\"product-selector\">\r\n        <text class=\"selector-label\">ÈÄâÊã©ÂåÖÂåÖÊ¨æÂºè</text>\r\n        <picker :range=\"products\" range-key=\"name\" @change=\"onProductChange\">\r\n          <view class=\"picker-view\">\r\n            <text>{{ selectedProduct?.name || 'ËØ∑ÈÄâÊã©' }}</text>\r\n            <text class=\"picker-arrow\">‚ñº</text>\r\n          </view>\r\n        </picker>\r\n      </view>\r\n      \r\n      <view class=\"spec-selector\" v-if=\"selectedProduct\">\r\n        <view class=\"spec-item\">\r\n          <text class=\"spec-label\">È¢úËâ≤</text>\r\n          <view class=\"spec-options\">\r\n            <view \r\n              class=\"spec-option\" \r\n              v-for=\"color in selectedProduct.colors\" \r\n              :key=\"color\"\r\n              :class=\"{ active: selectedColor === color }\"\r\n              @click=\"selectedColor = color\"\r\n            >{{ color }}</view>\r\n          </view>\r\n        </view>\r\n        \r\n        <view class=\"spec-item\">\r\n          <text class=\"spec-label\">Â∞∫ÂØ∏</text>\r\n          <view class=\"spec-options\">\r\n            <view \r\n              class=\"spec-option\" \r\n              v-for=\"size in selectedProduct.sizes\" \r\n              :key=\"size\"\r\n              :class=\"{ active: selectedSize === size }\"\r\n              @click=\"selectedSize = size\"\r\n            >{{ size }}</view>\r\n          </view>\r\n        </view>\r\n      </view>\r\n      \r\n      <!-- ÁîüÊàêÈ¢ÑËßàÊåâÈíÆ -->\r\n      <button \r\n        class=\"generate-btn\"\r\n        :class=\"{ disabled: !canGenerate || isGenerating }\"\r\n        :disabled=\"!canGenerate || isGenerating\"\r\n        @click=\"handleGeneratePreview\"\r\n      >\r\n        <text v-if=\"isGenerating\">ÁîüÊàê‰∏≠...</text>\r\n        <text v-else>ÁîüÊàêÈ¢ÑËßà</text>\r\n      </button>\r\n    </view>\r\n    \r\n    <!-- Êìç‰ΩúÂå∫Âüü -->\r\n    <view class=\"action-section\">\r\n      <button \r\n        class=\"add-cart-btn\" \r\n        :class=\"{ disabled: !canAddToCart }\"\r\n        :disabled=\"!canAddToCart\"\r\n        @click=\"handleAddToCart\"\r\n      >Âä†ÂÖ•Ë¥≠Áâ©ËΩ¶</button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed } from 'vue'\r\nimport { onLoad, onUnload } from '@dcloudio/uni-app'\r\nimport { productApi } from '@/api/product'\r\nimport { cartApi } from '@/api/cart'\r\nimport { generatePreview, getTaskStatus } from '@/api/preview'\r\n\r\n// Âü∫Á°ÄÊï∞ÊçÆ\r\nconst workId = ref(null)\r\nconst imageUrl = ref('')\r\nconst products = ref([])\r\nconst selectedProduct = ref(null)\r\nconst selectedColor = ref('')\r\nconst selectedSize = ref('')\r\n\r\n// È¢ÑËßàÁõ∏ÂÖ≥\r\nconst previewUrl = ref('')\r\nconst isGenerating = ref(false)\r\nconst taskId = ref(null)\r\nconst errorMessage = ref('')\r\nconst loadingText = ref('Ê≠£Âú®ÁîüÊàêÈ¢ÑËßàÔºåËØ∑Á®çÂÄô...')\r\nconst pollingTimer = ref(null)\r\n\r\n// ËÆ°ÁÆóÂ±ûÊÄß\r\nconst canGenerate = computed(() => {\r\n  return selectedProduct.value && selectedColor.value && selectedSize.value\r\n})\r\n\r\nconst canAddToCart = computed(() => {\r\n  return canGenerate.value && previewUrl.value && !isGenerating.value\r\n})\r\n\r\n// È°µÈù¢Âä†ËΩΩ\r\nonLoad(async (options) => {\r\n  workId.value = options.workId ? parseInt(options.workId) : null\r\n  imageUrl.value = decodeURIComponent(options.imageUrl || '')\r\n  \r\n  console.log('È¢ÑËßàÈ°µÈù¢Âä†ËΩΩ - workId:', workId.value, 'imageUrl:', imageUrl.value)\r\n  \r\n  if (!workId.value) {\r\n    uni.showToast({\r\n      title: 'Áº∫Â∞ë‰ΩúÂìÅID',\r\n      icon: 'none',\r\n      duration: 2000\r\n    })\r\n    return\r\n  }\r\n  \r\n  await loadProducts()\r\n})\r\n\r\n// Âä†ËΩΩÂïÜÂìÅÂàóË°®\r\nconst loadProducts = async () => {\r\n  try {\r\n    const res = await productApi.getProducts()\r\n    console.log('ÂïÜÂìÅÂàóË°®ÂìçÂ∫î:', res)\r\n    \r\n    if (res.code === 200 && res.data) {\r\n      products.value = res.data.map(product => {\r\n        // Ëß£Êûê colors Âíå sizes (Â¶ÇÊûúÊòØ JSON Â≠óÁ¨¶‰∏≤)\r\n        let colors = []\r\n        let sizes = []\r\n        \r\n        try {\r\n          colors = typeof product.colors === 'string' \r\n            ? JSON.parse(product.colors) \r\n            : (Array.isArray(product.colors) ? product.colors : [])\r\n        } catch (e) {\r\n          console.warn('Ëß£ÊûêÈ¢úËâ≤Â§±Ë¥•:', e)\r\n          colors = []\r\n        }\r\n        \r\n        try {\r\n          sizes = typeof product.sizes === 'string' \r\n            ? JSON.parse(product.sizes) \r\n            : (Array.isArray(product.sizes) ? product.sizes : [])\r\n        } catch (e) {\r\n          console.warn('Ëß£ÊûêÂ∞∫ÂØ∏Â§±Ë¥•:', e)\r\n          sizes = []\r\n        }\r\n        \r\n        return {\r\n          ...product,\r\n          colors,\r\n          sizes\r\n        }\r\n      })\r\n      \r\n      console.log('Â§ÑÁêÜÂêéÁöÑÂïÜÂìÅÂàóË°®:', products.value)\r\n    }\r\n  } catch (error) {\r\n    console.error('Âä†ËΩΩÂïÜÂìÅÂàóË°®Â§±Ë¥•:', error)\r\n    uni.showToast({\r\n      title: 'Âä†ËΩΩÂïÜÂìÅÂàóË°®Â§±Ë¥•',\r\n      icon: 'none'\r\n    })\r\n  }\r\n}\r\n\r\n// ÂïÜÂìÅÈÄâÊã©ÊîπÂèò\r\nconst onProductChange = (e) => {\r\n  const index = e.detail.value\r\n  selectedProduct.value = products.value[index]\r\n  selectedColor.value = ''\r\n  selectedSize.value = ''\r\n  previewUrl.value = ''\r\n  console.log('ÈÄâÊã©ÂïÜÂìÅ:', selectedProduct.value)\r\n}\r\n\r\n// ÁîüÊàêÈ¢ÑËßà\r\nconst handleGeneratePreview = async () => {\r\n  if (!canGenerate.value || isGenerating.value) {\r\n    return\r\n  }\r\n  \r\n  try {\r\n    isGenerating.value = true\r\n    errorMessage.value = ''\r\n    loadingText.value = 'Ê≠£Âú®ÁîüÊàêÈ¢ÑËßàÔºåËØ∑Á®çÂÄô...'\r\n    \r\n    console.log('ÂºÄÂßãÁîüÊàêÈ¢ÑËßà:', {\r\n      workId: workId.value,\r\n      productId: selectedProduct.value.id,\r\n      color: selectedColor.value,\r\n      size: selectedSize.value\r\n    })\r\n    \r\n    // Ë∞ÉÁî®È¢ÑËßàÁîüÊàêÊé•Âè£\r\n    const res = await generatePreview({\r\n      workId: workId.value,\r\n      productId: selectedProduct.value.id,\r\n      color: selectedColor.value,\r\n      size: selectedSize.value\r\n    })\r\n    \r\n    console.log('È¢ÑËßàÁîüÊàêÂìçÂ∫î:', res)\r\n    \r\n    if (res.code === 200) {\r\n      taskId.value = res.data.taskId\r\n      \r\n      // Â¶ÇÊûúÂ∑≤ÁªèÊúâÁºìÂ≠òÁªìÊûúÔºåÁõ¥Êé•ÊòæÁ§∫\r\n      if (res.data.status === 'COMPLETED' && res.data.resultUrl) {\r\n        previewUrl.value = res.data.resultUrl\r\n        isGenerating.value = false\r\n        \r\n        uni.showToast({\r\n          title: 'È¢ÑËßàÁîüÊàêÊàêÂäü',\r\n          icon: 'success',\r\n          duration: 2000\r\n        })\r\n      } else {\r\n        // ÂºÄÂßãËΩÆËØ¢‰ªªÂä°Áä∂ÊÄÅ\r\n        pollTaskStatus()\r\n      }\r\n    } else {\r\n      throw new Error(res.message || 'ÁîüÊàêÈ¢ÑËßàÂ§±Ë¥•')\r\n    }\r\n    \r\n  } catch (error) {\r\n    console.error('ÁîüÊàêÈ¢ÑËßàÂ§±Ë¥•:', error)\r\n    errorMessage.value = error.message || 'ÁîüÊàêÈ¢ÑËßàÂ§±Ë¥•ÔºåËØ∑ÈáçËØï'\r\n    isGenerating.value = false\r\n    \r\n    uni.showToast({\r\n      title: errorMessage.value,\r\n      icon: 'none',\r\n      duration: 2000\r\n    })\r\n  }\r\n}\r\n\r\n// ËΩÆËØ¢‰ªªÂä°Áä∂ÊÄÅ\r\nconst pollTaskStatus = async () => {\r\n  if (!taskId.value) {\r\n    return\r\n  }\r\n  \r\n  try {\r\n    const res = await getTaskStatus(taskId.value)\r\n    console.log('‰ªªÂä°Áä∂ÊÄÅ:', res)\r\n    \r\n    if (res.code === 200) {\r\n      const task = res.data\r\n      \r\n      if (task.status === 'COMPLETED') {\r\n        // ÁîüÊàêÂÆåÊàê\r\n        previewUrl.value = task.resultUrl\r\n        isGenerating.value = false\r\n        \r\n        // Ê∏ÖÈô§ÂÆöÊó∂Âô®\r\n        if (pollingTimer.value) {\r\n          clearTimeout(pollingTimer.value)\r\n          pollingTimer.value = null\r\n        }\r\n        \r\n        uni.showToast({\r\n          title: 'È¢ÑËßàÁîüÊàêÊàêÂäü',\r\n          icon: 'success',\r\n          duration: 2000\r\n        })\r\n        \r\n      } else if (task.status === 'FAILED') {\r\n        // ÁîüÊàêÂ§±Ë¥•\r\n        errorMessage.value = task.errorMessage || 'ÁîüÊàêÂ§±Ë¥•'\r\n        isGenerating.value = false\r\n        \r\n        // Ê∏ÖÈô§ÂÆöÊó∂Âô®\r\n        if (pollingTimer.value) {\r\n          clearTimeout(pollingTimer.value)\r\n          pollingTimer.value = null\r\n        }\r\n        \r\n        uni.showModal({\r\n          title: 'ÊèêÁ§∫',\r\n          content: errorMessage.value + 'ÔºåÊòØÂê¶ÈáçËØïÔºü',\r\n          success: (modalRes) => {\r\n            if (modalRes.confirm) {\r\n              handleRetry()\r\n            }\r\n          }\r\n        })\r\n        \r\n      } else {\r\n        // ÁªßÁª≠ËΩÆËØ¢\r\n        const progress = task.progress || 0\r\n        if (progress > 0) {\r\n          loadingText.value = `ÁîüÊàê‰∏≠ ${progress}%...`\r\n        }\r\n        \r\n        pollingTimer.value = setTimeout(pollTaskStatus, 2000)\r\n      }\r\n    }\r\n    \r\n  } catch (error) {\r\n    console.error('Êü•ËØ¢‰ªªÂä°Áä∂ÊÄÅÂ§±Ë¥•:', error)\r\n    isGenerating.value = false\r\n    errorMessage.value = 'Êü•ËØ¢‰ªªÂä°Áä∂ÊÄÅÂ§±Ë¥•'\r\n    \r\n    // Ê∏ÖÈô§ÂÆöÊó∂Âô®\r\n    if (pollingTimer.value) {\r\n      clearTimeout(pollingTimer.value)\r\n      pollingTimer.value = null\r\n    }\r\n  }\r\n}\r\n\r\n// ÈáçÊñ∞ÁîüÊàê\r\nconst handleRegenerate = () => {\r\n  console.log('ÈáçÊñ∞ÁîüÊàêÈ¢ÑËßà')\r\n  \r\n  // Ê∏ÖÈô§ÂÆöÊó∂Âô®\r\n  if (pollingTimer.value) {\r\n    clearTimeout(pollingTimer.value)\r\n    pollingTimer.value = null\r\n  }\r\n  \r\n  // ÈáçÁΩÆÊâÄÊúâÁä∂ÊÄÅ\r\n  previewUrl.value = ''\r\n  taskId.value = null\r\n  errorMessage.value = ''\r\n  isGenerating.value = false\r\n  \r\n  // ÈáçÊñ∞ÁîüÊàê\r\n  handleGeneratePreview()\r\n}\r\n\r\n// ÈáçËØïÔºàÂ§±Ë¥•ÂêéÈáçËØïÔºâ\r\nconst handleRetry = () => {\r\n  console.log('ÈáçËØïÁîüÊàêÈ¢ÑËßà')\r\n  \r\n  // Ê∏ÖÈô§ÂÆöÊó∂Âô®\r\n  if (pollingTimer.value) {\r\n    clearTimeout(pollingTimer.value)\r\n    pollingTimer.value = null\r\n  }\r\n  \r\n  // ÈáçÁΩÆÁä∂ÊÄÅ\r\n  previewUrl.value = ''\r\n  taskId.value = null  // ‚úÖ ÈáçË¶ÅÔºöÊ∏ÖÈô§ÊóßÁöÑ‰ªªÂä°ID\r\n  errorMessage.value = ''\r\n  isGenerating.value = false\r\n  \r\n  // ÈáçÊñ∞ÁîüÊàêÔºà‰ºöÂàõÂª∫Êñ∞‰ªªÂä°Ôºâ\r\n  handleGeneratePreview()\r\n}\r\n\r\n// Âä†ÂÖ•Ë¥≠Áâ©ËΩ¶\r\nconst handleAddToCart = async () => {\r\n  if (!canAddToCart.value) {\r\n    return\r\n  }\r\n  \r\n  try {\r\n    uni.showLoading({\r\n      title: 'Âä†ÂÖ•‰∏≠...'\r\n    })\r\n    \r\n    const res = await cartApi.addToCart({\r\n      workId: workId.value,\r\n      productId: selectedProduct.value.id,\r\n      color: selectedColor.value,\r\n      size: selectedSize.value,\r\n      quantity: 1,\r\n      previewImageUrl: previewUrl.value\r\n    })\r\n    \r\n    uni.hideLoading()\r\n    \r\n    if (res.code === 200) {\r\n      uni.showToast({\r\n        title: 'Â∑≤Âä†ÂÖ•Ë¥≠Áâ©ËΩ¶',\r\n        icon: 'success',\r\n        duration: 1500\r\n      })\r\n      \r\n      setTimeout(() => {\r\n        uni.switchTab({\r\n          url: '/pages/cart/cart'\r\n        })\r\n      }, 1500)\r\n    } else {\r\n      throw new Error(res.message || 'Âä†ÂÖ•Ë¥≠Áâ©ËΩ¶Â§±Ë¥•')\r\n    }\r\n    \r\n  } catch (error) {\r\n    console.error('Âä†ÂÖ•Ë¥≠Áâ©ËΩ¶Â§±Ë¥•:', error)\r\n    uni.hideLoading()\r\n    uni.showToast({\r\n      title: error.message || 'Âä†ÂÖ•Ë¥≠Áâ©ËΩ¶Â§±Ë¥•',\r\n      icon: 'none',\r\n      duration: 2000\r\n    })\r\n  }\r\n}\r\n\r\n// È°µÈù¢Âç∏ËΩΩÊó∂Ê∏ÖÈô§ÂÆöÊó∂Âô®\r\nonUnload(() => {\r\n  if (pollingTimer.value) {\r\n    clearTimeout(pollingTimer.value)\r\n    pollingTimer.value = null\r\n  }\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.preview-container {\r\n  min-height: 100vh;\r\n  background-color: #f5f5f5;\r\n  padding-bottom: 100rpx;\r\n}\r\n\r\n/* È¢ÑËßàÂå∫Âüü */\r\n.preview-section {\r\n  background-color: #fff;\r\n  padding: 40rpx;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.preview-placeholder {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  min-height: 600rpx;\r\n  background-color: #fafafa;\r\n  border-radius: 16rpx;\r\n  border: 2rpx dashed #ddd;\r\n}\r\n\r\n.placeholder-image {\r\n  width: 400rpx;\r\n  height: 400rpx;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.placeholder-hint {\r\n  font-size: 28rpx;\r\n  color: #999;\r\n}\r\n\r\n.preview-loading {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  min-height: 600rpx;\r\n  background-color: #fafafa;\r\n  border-radius: 16rpx;\r\n}\r\n\r\n.loading-spinner {\r\n  width: 80rpx;\r\n  height: 80rpx;\r\n  border: 6rpx solid #f3f3f3;\r\n  border-top: 6rpx solid #07c160;\r\n  border-radius: 50%;\r\n  animation: spin 1s linear infinite;\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n\r\n.loading-text {\r\n  font-size: 32rpx;\r\n  color: #333;\r\n  margin-bottom: 10rpx;\r\n}\r\n\r\n.loading-tip {\r\n  font-size: 24rpx;\r\n  color: #999;\r\n}\r\n\r\n.preview-result {\r\n  position: relative;\r\n}\r\n\r\n.preview-image {\r\n  width: 100%;\r\n  min-height: 600rpx;\r\n  border-radius: 16rpx;\r\n  background-color: #fafafa;\r\n}\r\n\r\n.regenerate-btn {\r\n  position: absolute;\r\n  bottom: 20rpx;\r\n  right: 20rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10rpx;\r\n  padding: 16rpx 32rpx;\r\n  background-color: rgba(255, 255, 255, 0.9);\r\n  border: 1rpx solid #ddd;\r\n  border-radius: 40rpx;\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.btn-icon {\r\n  font-size: 32rpx;\r\n}\r\n\r\n.error-message {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  min-height: 400rpx;\r\n  background-color: #fff5f5;\r\n  border-radius: 16rpx;\r\n  border: 2rpx solid #ffebee;\r\n  padding: 40rpx;\r\n}\r\n\r\n.error-icon {\r\n  font-size: 80rpx;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.error-text {\r\n  font-size: 28rpx;\r\n  color: #f56c6c;\r\n  text-align: center;\r\n  margin-bottom: 30rpx;\r\n  line-height: 1.6;\r\n}\r\n\r\n.retry-btn {\r\n  padding: 16rpx 48rpx;\r\n  background-color: #07c160;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 40rpx;\r\n  font-size: 28rpx;\r\n}\r\n\r\n/* ÂïÜÂìÅÈÄâÊã©Âå∫Âüü */\r\n.product-section {\r\n  background-color: #fff;\r\n  padding: 40rpx;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.product-selector {\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.selector-label {\r\n  display: block;\r\n  font-size: 28rpx;\r\n  color: #666;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.picker-view {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 24rpx 30rpx;\r\n  background-color: #f8f8f8;\r\n  border-radius: 12rpx;\r\n  font-size: 30rpx;\r\n  color: #333;\r\n}\r\n\r\n.picker-arrow {\r\n  font-size: 24rpx;\r\n  color: #999;\r\n}\r\n\r\n.spec-selector {\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.spec-item {\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.spec-label {\r\n  display: block;\r\n  font-size: 28rpx;\r\n  color: #666;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.spec-options {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 20rpx;\r\n}\r\n\r\n.spec-option {\r\n  padding: 16rpx 32rpx;\r\n  background-color: #f8f8f8;\r\n  border: 2rpx solid transparent;\r\n  border-radius: 40rpx;\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.spec-option.active {\r\n  background-color: #e8f5e9;\r\n  border-color: #07c160;\r\n  color: #07c160;\r\n}\r\n\r\n.generate-btn {\r\n  width: 100%;\r\n  padding: 28rpx;\r\n  background-color: #07c160;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 12rpx;\r\n  font-size: 32rpx;\r\n  font-weight: 500;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.generate-btn.disabled {\r\n  background-color: #ddd;\r\n  color: #999;\r\n}\r\n\r\n/* Êìç‰ΩúÂå∫Âüü */\r\n.action-section {\r\n  position: fixed;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  padding: 20rpx 40rpx;\r\n  background-color: #fff;\r\n  box-shadow: 0 -4rpx 12rpx rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.add-cart-btn {\r\n  width: 100%;\r\n  padding: 28rpx;\r\n  background-color: #ff6b6b;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 12rpx;\r\n  font-size: 32rpx;\r\n  font-weight: 500;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.add-cart-btn.disabled {\r\n  background-color: #ddd;\r\n  color: #999;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/code/my-shop-cursor/frontend/pages/preview/preview.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","onLoad","uni","productApi","generatePreview","getTaskStatus","cartApi","onUnload"],"mappings":"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"}