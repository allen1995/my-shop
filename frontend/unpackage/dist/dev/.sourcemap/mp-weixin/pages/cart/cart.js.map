{"version":3,"file":"cart.js","sources":["pages/cart/cart.vue","../../../software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2FydC9jYXJ0LnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"cart-container\">\r\n    <view class=\"cart-list\" v-if=\"cartItems.length > 0\">\r\n      <view class=\"cart-item\" v-for=\"item in cartItems\" :key=\"item.id\">\r\n        <image class=\"item-image\" :src=\"item.previewImageUrl\" mode=\"aspectFill\"></image>\r\n        <view class=\"item-info\">\r\n          <text class=\"item-title\">定制包包</text>\r\n          <text class=\"item-spec\">颜色：{{ item.color }} | 尺寸：{{ item.size }}</text>\r\n          <view class=\"item-footer\">\r\n            <text class=\"item-price\">¥{{ item.price || 0 }}</text>\r\n            <view class=\"quantity-control\">\r\n              <text class=\"quantity-btn\" @click=\"decreaseQuantity(item)\">-</text>\r\n              <text class=\"quantity-value\">{{ item.quantity }}</text>\r\n              <text class=\"quantity-btn\" @click=\"increaseQuantity(item)\">+</text>\r\n            </view>\r\n          </view>\r\n        </view>\r\n        <text class=\"delete-btn\" @click=\"handleDelete(item.id)\">删除</text>\r\n      </view>\r\n    </view>\r\n    \r\n    <view class=\"empty-state\" v-else>\r\n      <image class=\"empty-icon\" src=\"/static/icons/empty-cart.png\" mode=\"aspectFit\"></image>\r\n      <text class=\"empty-text\">购物车是空的</text>\r\n      <button class=\"empty-btn\" @click=\"goToIndex\">去逛逛</button>\r\n    </view>\r\n    \r\n    <view class=\"footer-section\" v-if=\"cartItems.length > 0\">\r\n      <view class=\"total-info\">\r\n        <text class=\"total-label\">合计：</text>\r\n        <text class=\"total-amount\">¥{{ totalAmount }}</text>\r\n      </view>\r\n      <button class=\"checkout-btn\" @click=\"goToCheckout\">去结算</button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted } from 'vue'\r\nimport { cartApi } from '@/api/cart'\r\nimport { onPullDownRefresh } from '@dcloudio/uni-app'\r\n\r\nconst cartItems = ref([])\r\n\r\nconst totalAmount = computed(() => {\r\n  return cartItems.value.reduce((sum, item) => {\r\n    return sum + (item.price || 0) * item.quantity\r\n  }, 0).toFixed(2)\r\n})\r\n\r\nconst loadCartItems = async () => {\r\n  try {\r\n    const res = await cartApi.getCartItems()\r\n    if (res.code === 200 && res.data) {\r\n      cartItems.value = res.data || []\r\n    }\r\n  } catch (error) {\r\n    console.error('加载购物车失败', error)\r\n  } finally {\r\n    uni.stopPullDownRefresh()\r\n  }\r\n}\r\n\r\nconst increaseQuantity = async (item) => {\r\n  try {\r\n    await cartApi.updateCartItem(item.id, {\r\n      quantity: item.quantity + 1\r\n    })\r\n    await loadCartItems()\r\n  } catch (error) {\r\n    uni.showToast({\r\n      title: '更新失败',\r\n      icon: 'none'\r\n    })\r\n  }\r\n}\r\n\r\nconst decreaseQuantity = async (item) => {\r\n  if (item.quantity <= 1) return\r\n  \r\n  try {\r\n    await cartApi.updateCartItem(item.id, {\r\n      quantity: item.quantity - 1\r\n    })\r\n    await loadCartItems()\r\n  } catch (error) {\r\n    uni.showToast({\r\n      title: '更新失败',\r\n      icon: 'none'\r\n    })\r\n  }\r\n}\r\n\r\nconst handleDelete = async (itemId) => {\r\n  uni.showModal({\r\n    title: '确认删除',\r\n    content: '确定要删除这个商品吗？',\r\n    success: async (res) => {\r\n      if (res.confirm) {\r\n        try {\r\n          await cartApi.deleteCartItem(itemId)\r\n          await loadCartItems()\r\n          uni.showToast({\r\n            title: '删除成功',\r\n            icon: 'success'\r\n          })\r\n        } catch (error) {\r\n          uni.showToast({\r\n            title: '删除失败',\r\n            icon: 'none'\r\n          })\r\n        }\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nconst goToCheckout = () => {\r\n  uni.navigateTo({\r\n    url: '/pages/order/confirm'\r\n  })\r\n}\r\n\r\nconst goToIndex = () => {\r\n  uni.switchTab({\r\n    url: '/pages/index/index'\r\n  })\r\n}\r\n\r\nonMounted(() => {\r\n  loadCartItems()\r\n})\r\n\r\nonPullDownRefresh(() => {\r\n  loadCartItems()\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.cart-container {\r\n  min-height: 100vh;\r\n  background-color: #F8F8F8;\r\n  padding-bottom: 120rpx;\r\n}\r\n\r\n.cart-list {\r\n  padding: 20rpx;\r\n  \r\n  .cart-item {\r\n    background: #ffffff;\r\n    border-radius: 20rpx;\r\n    padding: 30rpx;\r\n    margin-bottom: 20rpx;\r\n    display: flex;\r\n    align-items: center;\r\n    \r\n    .item-image {\r\n      width: 160rpx;\r\n      height: 160rpx;\r\n      border-radius: 10rpx;\r\n      margin-right: 20rpx;\r\n    }\r\n    \r\n    .item-info {\r\n      flex: 1;\r\n      \r\n      .item-title {\r\n        display: block;\r\n        font-size: 32rpx;\r\n        font-weight: bold;\r\n        color: #333333;\r\n        margin-bottom: 10rpx;\r\n      }\r\n      \r\n      .item-spec {\r\n        display: block;\r\n        font-size: 24rpx;\r\n        color: #999999;\r\n        margin-bottom: 20rpx;\r\n      }\r\n      \r\n      .item-footer {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        \r\n        .item-price {\r\n          font-size: 36rpx;\r\n          font-weight: bold;\r\n          color: #FF3B30;\r\n        }\r\n        \r\n        .quantity-control {\r\n          display: flex;\r\n          align-items: center;\r\n          gap: 20rpx;\r\n          \r\n          .quantity-btn {\r\n            width: 50rpx;\r\n            height: 50rpx;\r\n            background: #F5F5F5;\r\n            border-radius: 8rpx;\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            font-size: 32rpx;\r\n            color: #333333;\r\n          }\r\n          \r\n          .quantity-value {\r\n            font-size: 28rpx;\r\n            color: #333333;\r\n            min-width: 40rpx;\r\n            text-align: center;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    .delete-btn {\r\n      padding: 10rpx 20rpx;\r\n      color: #FF3B30;\r\n      font-size: 28rpx;\r\n    }\r\n  }\r\n}\r\n\r\n.empty-state {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 200rpx 40rpx;\r\n  \r\n  .empty-icon {\r\n    width: 200rpx;\r\n    height: 200rpx;\r\n    margin-bottom: 40rpx;\r\n    opacity: 0.5;\r\n  }\r\n  \r\n  .empty-text {\r\n    font-size: 32rpx;\r\n    color: #999999;\r\n    margin-bottom: 40rpx;\r\n  }\r\n  \r\n  .empty-btn {\r\n    padding: 20rpx 60rpx;\r\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n    color: #ffffff;\r\n    border-radius: 44rpx;\r\n    font-size: 28rpx;\r\n    border: none;\r\n  }\r\n}\r\n\r\n.footer-section {\r\n  position: fixed;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  background: #ffffff;\r\n  padding: 30rpx 40rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  box-shadow: 0 -4rpx 20rpx rgba(0, 0, 0, 0.1);\r\n  \r\n  .total-info {\r\n    .total-label {\r\n      font-size: 28rpx;\r\n      color: #666666;\r\n      margin-right: 10rpx;\r\n    }\r\n    \r\n    .total-amount {\r\n      font-size: 40rpx;\r\n      font-weight: bold;\r\n      color: #FF3B30;\r\n    }\r\n  }\r\n  \r\n  .checkout-btn {\r\n    padding: 20rpx 60rpx;\r\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n    color: #ffffff;\r\n    border-radius: 44rpx;\r\n    font-size: 32rpx;\r\n    font-weight: bold;\r\n    border: none;\r\n  }\r\n}\r\n</style>\r\n\r\n\r\n","import MiniProgramPage from 'D:/code/my-shop-cursor/frontend/pages/cart/cart.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","cartApi","uni","onMounted","onPullDownRefresh"],"mappings":";;;;;;;AA0CA,UAAM,YAAYA,cAAG,IAAC,EAAE;AAExB,UAAM,cAAcC,cAAQ,SAAC,MAAM;AACjC,aAAO,UAAU,MAAM,OAAO,CAAC,KAAK,SAAS;AAC3C,eAAO,OAAO,KAAK,SAAS,KAAK,KAAK;AAAA,MAC1C,GAAK,CAAC,EAAE,QAAQ,CAAC;AAAA,IACjB,CAAC;AAED,UAAM,gBAAgB,YAAY;AAChC,UAAI;AACF,cAAM,MAAM,MAAMC,SAAO,QAAC,aAAc;AACxC,YAAI,IAAI,SAAS,OAAO,IAAI,MAAM;AAChC,oBAAU,QAAQ,IAAI,QAAQ,CAAE;AAAA,QACjC;AAAA,MACF,SAAQ,OAAO;AACdC,sBAAAA,MAAA,MAAA,SAAA,6BAAc,WAAW,KAAK;AAAA,MAClC,UAAY;AACRA,sBAAAA,MAAI,oBAAqB;AAAA,MAC1B;AAAA,IACH;AAEA,UAAM,mBAAmB,OAAO,SAAS;AACvC,UAAI;AACF,cAAMD,iBAAQ,eAAe,KAAK,IAAI;AAAA,UACpC,UAAU,KAAK,WAAW;AAAA,QAChC,CAAK;AACD,cAAM,cAAe;AAAA,MACtB,SAAQ,OAAO;AACdC,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACF;AAAA,IACH;AAEA,UAAM,mBAAmB,OAAO,SAAS;AACvC,UAAI,KAAK,YAAY;AAAG;AAExB,UAAI;AACF,cAAMD,iBAAQ,eAAe,KAAK,IAAI;AAAA,UACpC,UAAU,KAAK,WAAW;AAAA,QAChC,CAAK;AACD,cAAM,cAAe;AAAA,MACtB,SAAQ,OAAO;AACdC,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACF;AAAA,IACH;AAEA,UAAM,eAAe,OAAO,WAAW;AACrCA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,OAAO,QAAQ;AACtB,cAAI,IAAI,SAAS;AACf,gBAAI;AACF,oBAAMD,SAAO,QAAC,eAAe,MAAM;AACnC,oBAAM,cAAe;AACrBC,4BAAAA,MAAI,UAAU;AAAA,gBACZ,OAAO;AAAA,gBACP,MAAM;AAAA,cAClB,CAAW;AAAA,YACF,SAAQ,OAAO;AACdA,4BAAAA,MAAI,UAAU;AAAA,gBACZ,OAAO;AAAA,gBACP,MAAM;AAAA,cAClB,CAAW;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;AAEA,UAAM,eAAe,MAAM;AACzBA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,MACT,CAAG;AAAA,IACH;AAEA,UAAM,YAAY,MAAM;AACtBA,oBAAAA,MAAI,UAAU;AAAA,QACZ,KAAK;AAAA,MACT,CAAG;AAAA,IACH;AAEAC,kBAAAA,UAAU,MAAM;AACd,oBAAe;AAAA,IACjB,CAAC;AAEDC,kBAAAA,kBAAkB,MAAM;AACtB,oBAAe;AAAA,IACjB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtID,GAAG,WAAW,eAAe;"}