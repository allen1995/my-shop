{"version":3,"file":"login.js","sources":["pages/login/login.vue","../../../software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<template>\r\n  <view class=\"login-container\">\r\n    <view class=\"logo-section\">\r\n      <image class=\"logo\" src=\"/static/logo.png\" mode=\"aspectFit\"></image>\r\n      <text class=\"title\">AI印花电商</text>\r\n      <text class=\"subtitle\">让AI帮你设计独特的包包</text>\r\n    </view>\r\n    \r\n    <view class=\"login-section\">\r\n      <button class=\"login-btn\" @click=\"handleWeChatLogin\" :loading=\"loading\">\r\n        微信一键登录\r\n      </button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue'\r\nimport { useUserStore } from '@/store/user'\r\nimport { onLoad } from '@dcloudio/uni-app'\r\n\r\nconst userStore = useUserStore()\r\nconst loading = ref(false)\r\n\r\nconst handleWeChatLogin = async () => {\r\n  loading.value = true\r\n  try {\r\n    // 获取微信登录code\r\n    const loginRes = await new Promise((resolve, reject) => {\r\n      uni.login({\r\n        provider: 'weixin',\r\n        success: resolve,\r\n        fail: reject\r\n      })\r\n    })\r\n    \r\n    if (loginRes.code) {\r\n      // 调用后端登录接口\r\n      const success = await userStore.login(loginRes.code)\r\n      \r\n      if (success) {\r\n        uni.showToast({\r\n          title: '登录成功',\r\n          icon: 'success'\r\n        })\r\n        \r\n        // 跳转到首页\r\n        setTimeout(() => {\r\n          uni.switchTab({\r\n            url: '/pages/index/index'\r\n          })\r\n        }, 1500)\r\n      } else {\r\n        uni.showToast({\r\n          title: '登录失败，请重试',\r\n          icon: 'none'\r\n        })\r\n      }\r\n    }\r\n  } catch (error) {\r\n    console.error('登录错误', error)\r\n    uni.showToast({\r\n      title: '登录失败',\r\n      icon: 'none'\r\n    })\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nonLoad(() => {\r\n  // 如果已登录，直接跳转\r\n  if (userStore.token) {\r\n    uni.switchTab({\r\n      url: '/pages/index/index'\r\n    })\r\n  }\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.login-container {\r\n  min-height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 40rpx;\r\n  background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);\r\n}\r\n\r\n.logo-section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  margin-bottom: 100rpx;\r\n  \r\n  .logo {\r\n    width: 200rpx;\r\n    height: 200rpx;\r\n    margin-bottom: 40rpx;\r\n  }\r\n  \r\n  .title {\r\n    font-size: 48rpx;\r\n    font-weight: bold;\r\n    color: #ffffff;\r\n    margin-bottom: 20rpx;\r\n  }\r\n  \r\n  .subtitle {\r\n    font-size: 28rpx;\r\n    color: rgba(255, 255, 255, 0.8);\r\n  }\r\n}\r\n\r\n.login-section {\r\n  width: 100%;\r\n  \r\n  .login-btn {\r\n    width: 100%;\r\n    height: 88rpx;\r\n    background-color: #ffffff;\r\n    color: #667eea;\r\n    border-radius: 44rpx;\r\n    font-size: 32rpx;\r\n    font-weight: bold;\r\n    border: none;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n  }\r\n}\r\n</style>\r\n\r\n\r\n","import MiniProgramPage from 'D:/code/my-shop-cursor/frontend/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["useUserStore","ref","uni","onLoad"],"mappings":";;;;;;;AAqBA,UAAM,YAAYA,WAAAA,aAAc;AAChC,UAAM,UAAUC,cAAG,IAAC,KAAK;AAEzB,UAAM,oBAAoB,YAAY;AACpC,cAAQ,QAAQ;AAChB,UAAI;AAEF,cAAM,WAAW,MAAM,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtDC,wBAAAA,MAAI,MAAM;AAAA,YACR,UAAU;AAAA,YACV,SAAS;AAAA,YACT,MAAM;AAAA,UACd,CAAO;AAAA,QACP,CAAK;AAED,YAAI,SAAS,MAAM;AAEjB,gBAAM,UAAU,MAAM,UAAU,MAAM,SAAS,IAAI;AAEnD,cAAI,SAAS;AACXA,0BAAAA,MAAI,UAAU;AAAA,cACZ,OAAO;AAAA,cACP,MAAM;AAAA,YAChB,CAAS;AAGD,uBAAW,MAAM;AACfA,4BAAAA,MAAI,UAAU;AAAA,gBACZ,KAAK;AAAA,cACjB,CAAW;AAAA,YACF,GAAE,IAAI;AAAA,UACf,OAAa;AACLA,0BAAAA,MAAI,UAAU;AAAA,cACZ,OAAO;AAAA,cACP,MAAM;AAAA,YAChB,CAAS;AAAA,UACF;AAAA,QACF;AAAA,MACF,SAAQ,OAAO;AACdA,sBAAAA,oDAAc,QAAQ,KAAK;AAC3BA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACL,UAAY;AACR,gBAAQ,QAAQ;AAAA,MACjB;AAAA,IACH;AAEAC,kBAAAA,OAAO,MAAM;AAEX,UAAI,UAAU,OAAO;AACnBD,sBAAAA,MAAI,UAAU;AAAA,UACZ,KAAK;AAAA,QACX,CAAK;AAAA,MACF;AAAA,IACH,CAAC;;;;;;;;;;;AC5ED,GAAG,WAAW,eAAe;"}