{"version":3,"file":"text-to-image.js","sources":["pages/generate/text-to-image.vue","../../../software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZ2VuZXJhdGUvdGV4dC10by1pbWFnZS52dWU"],"sourcesContent":["<template>\r\n  <view class=\"generate-container\">\r\n    <view class=\"input-section\">\r\n      <textarea \r\n        class=\"prompt-input\" \r\n        v-model=\"prompt\" \r\n        placeholder=\"描述你想要生成的图片，例如：一只可爱的小猫，卡通风格，粉色背景\"\r\n        maxlength=\"500\"\r\n      ></textarea>\r\n      <text class=\"char-count\">{{ prompt.length }}/500</text>\r\n    </view>\r\n    \r\n    <view class=\"params-section\">\r\n      <view class=\"param-item\">\r\n        <text class=\"param-label\">图片尺寸</text>\r\n        <view class=\"param-options\">\r\n          <view \r\n            class=\"param-option\" \r\n            :class=\"{ active: size === 'square' }\"\r\n            @click=\"size = 'square'\"\r\n          >正方形</view>\r\n          <view \r\n            class=\"param-option\" \r\n            :class=\"{ active: size === 'landscape' }\"\r\n            @click=\"size = 'landscape'\"\r\n          >横版</view>\r\n          <view \r\n            class=\"param-option\" \r\n            :class=\"{ active: size === 'portrait' }\"\r\n            @click=\"size = 'portrait'\"\r\n          >竖版</view>\r\n        </view>\r\n      </view>\r\n      \r\n      <view class=\"param-item\">\r\n        <text class=\"param-label\">风格</text>\r\n        <view class=\"param-options\">\r\n          <view \r\n            class=\"param-option\" \r\n            :class=\"{ active: style === 'realistic' }\"\r\n            @click=\"style = 'realistic'\"\r\n          >写实</view>\r\n          <view \r\n            class=\"param-option\" \r\n            :class=\"{ active: style === 'illustration' }\"\r\n            @click=\"style = 'illustration'\"\r\n          >插画</view>\r\n          <view \r\n            class=\"param-option\" \r\n            :class=\"{ active: style === 'abstract' }\"\r\n            @click=\"style = 'abstract'\"\r\n          >抽象</view>\r\n          <view \r\n            class=\"param-option\" \r\n            :class=\"{ active: style === 'watercolor' }\"\r\n            @click=\"style = 'watercolor'\"\r\n          >水彩</view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    \r\n    <view class=\"action-section\">\r\n      <button \r\n        class=\"generate-btn\" \r\n        :disabled=\"!canGenerate\" \r\n        :loading=\"generating\"\r\n        @click=\"handleGenerate\"\r\n      >\r\n        {{ generating ? '生成中...' : '开始生成' }}\r\n      </button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed } from 'vue'\r\nimport { imageGenerationApi } from '@/api/imageGeneration'\r\n\r\nconst prompt = ref('')\r\nconst size = ref('square')\r\nconst style = ref('realistic')\r\nconst generating = ref(false)\r\n\r\nconst canGenerate = computed(() => {\r\n  return prompt.value.trim().length > 0 && !generating.value\r\n})\r\n\r\nconst handleGenerate = async () => {\r\n  if (!canGenerate.value) return\r\n  \r\n  generating.value = true\r\n  \r\n  try {\r\n    const res = await imageGenerationApi.textToImage({\r\n      prompt: prompt.value,\r\n      parameters: {\r\n        size: size.value,\r\n        style: style.value\r\n      }\r\n    })\r\n    \r\n    if (res.code === 200 && res.data) {\r\n      const taskId = res.data.taskId\r\n      \r\n      if (!taskId) {\r\n        uni.showToast({\r\n          title: '生成失败：未获取到任务ID',\r\n          icon: 'none'\r\n        })\r\n        return\r\n      }\r\n      \r\n      // 跳转到生成进度页\r\n      uni.navigateTo({\r\n        url: `/pages/generate/generating?taskId=${taskId}`\r\n      })\r\n    } else {\r\n      uni.showToast({\r\n        title: res.message || '生成失败',\r\n        icon: 'none'\r\n      })\r\n    }\r\n  } catch (error) {\r\n    console.error('生成失败', error)\r\n    uni.showToast({\r\n      title: '生成失败，请重试',\r\n      icon: 'none'\r\n    })\r\n  } finally {\r\n    generating.value = false\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.generate-container {\r\n  padding: 40rpx;\r\n  min-height: 100vh;\r\n  background-color: #F8F8F8;\r\n}\r\n\r\n.input-section {\r\n  background: #ffffff;\r\n  border-radius: 20rpx;\r\n  padding: 30rpx;\r\n  margin-bottom: 30rpx;\r\n  \r\n  .prompt-input {\r\n    width: 100%;\r\n    min-height: 300rpx;\r\n    font-size: 28rpx;\r\n    line-height: 1.6;\r\n    color: #333333;\r\n  }\r\n  \r\n  .char-count {\r\n    display: block;\r\n    text-align: right;\r\n    font-size: 24rpx;\r\n    color: #999999;\r\n    margin-top: 20rpx;\r\n  }\r\n}\r\n\r\n.params-section {\r\n  background: #ffffff;\r\n  border-radius: 20rpx;\r\n  padding: 30rpx;\r\n  margin-bottom: 30rpx;\r\n  \r\n  .param-item {\r\n    margin-bottom: 40rpx;\r\n    \r\n    &:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n    \r\n    .param-label {\r\n      display: block;\r\n      font-size: 32rpx;\r\n      font-weight: bold;\r\n      color: #333333;\r\n      margin-bottom: 20rpx;\r\n    }\r\n    \r\n    .param-options {\r\n      display: flex;\r\n      gap: 20rpx;\r\n      flex-wrap: wrap;\r\n      \r\n      .param-option {\r\n        padding: 20rpx 40rpx;\r\n        background: #F5F5F5;\r\n        border-radius: 10rpx;\r\n        font-size: 28rpx;\r\n        color: #666666;\r\n        \r\n        &.active {\r\n          background: #007AFF;\r\n          color: #ffffff;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.action-section {\r\n  position: fixed;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  padding: 30rpx 40rpx;\r\n  background: #ffffff;\r\n  box-shadow: 0 -4rpx 20rpx rgba(0, 0, 0, 0.1);\r\n  \r\n  .generate-btn {\r\n    width: 100%;\r\n    height: 88rpx;\r\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n    color: #ffffff;\r\n    border-radius: 44rpx;\r\n    font-size: 32rpx;\r\n    font-weight: bold;\r\n    border: none;\r\n    \r\n    &[disabled] {\r\n      background: #CCCCCC;\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n\r\n","import MiniProgramPage from 'D:/code/my-shop-cursor/frontend/pages/generate/text-to-image.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","imageGenerationApi","uni"],"mappings":";;;;;;AA8EA,UAAM,SAASA,cAAG,IAAC,EAAE;AACrB,UAAM,OAAOA,cAAG,IAAC,QAAQ;AACzB,UAAM,QAAQA,cAAG,IAAC,WAAW;AAC7B,UAAM,aAAaA,cAAG,IAAC,KAAK;AAE5B,UAAM,cAAcC,cAAQ,SAAC,MAAM;AACjC,aAAO,OAAO,MAAM,KAAI,EAAG,SAAS,KAAK,CAAC,WAAW;AAAA,IACvD,CAAC;AAED,UAAM,iBAAiB,YAAY;AACjC,UAAI,CAAC,YAAY;AAAO;AAExB,iBAAW,QAAQ;AAEnB,UAAI;AACF,cAAM,MAAM,MAAMC,oBAAkB,mBAAC,YAAY;AAAA,UAC/C,QAAQ,OAAO;AAAA,UACf,YAAY;AAAA,YACV,MAAM,KAAK;AAAA,YACX,OAAO,MAAM;AAAA,UACd;AAAA,QACP,CAAK;AAED,YAAI,IAAI,SAAS,OAAO,IAAI,MAAM;AAChC,gBAAM,SAAS,IAAI,KAAK;AAExB,cAAI,CAAC,QAAQ;AACXC,0BAAAA,MAAI,UAAU;AAAA,cACZ,OAAO;AAAA,cACP,MAAM;AAAA,YAChB,CAAS;AACD;AAAA,UACD;AAGDA,wBAAAA,MAAI,WAAW;AAAA,YACb,KAAK,qCAAqC,MAAM;AAAA,UACxD,CAAO;AAAA,QACP,OAAW;AACLA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO,IAAI,WAAW;AAAA,YACtB,MAAM;AAAA,UACd,CAAO;AAAA,QACF;AAAA,MACF,SAAQ,OAAO;AACdA,sBAAAA,gEAAc,QAAQ,KAAK;AAC3BA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACL,UAAY;AACR,mBAAW,QAAQ;AAAA,MACpB;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClIA,GAAG,WAAW,eAAe;"}