{"version":3,"file":"result.js","sources":["pages/generate/result.vue","../../../software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZ2VuZXJhdGUvcmVzdWx0LnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"result-container\">\r\n    <view class=\"image-section\">\r\n      <image class=\"result-image\" :src=\"imageUrl\" mode=\"aspectFit\" @click=\"previewImage\"></image>\r\n    </view>\r\n    \r\n    <view class=\"action-section\">\r\n      <button class=\"action-btn save-btn\" @click=\"handleSave\">保存到作品集</button>\r\n      <button class=\"action-btn apply-btn\" @click=\"handleApply\">应用到包包</button>\r\n      <button class=\"action-btn regenerate-btn\" @click=\"handleRegenerate\">重新生成</button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue'\r\nimport { workApi } from '@/api/work'\r\nimport { onLoad } from '@dcloudio/uni-app'\r\n\r\nconst imageUrl = ref('')\r\nconst taskId = ref(null)\r\n\r\nonLoad((options) => {\r\n  imageUrl.value = decodeURIComponent(options.imageUrl || '')\r\n  taskId.value = options.taskId\r\n})\r\n\r\nconst previewImage = () => {\r\n  uni.previewImage({\r\n    urls: [imageUrl.value],\r\n    current: imageUrl.value\r\n  })\r\n}\r\n\r\nconst handleSave = async () => {\r\n  uni.showModal({\r\n    title: '保存作品',\r\n    editable: true,\r\n    placeholderText: '请输入作品标题',\r\n    success: async (res) => {\r\n      if (res.confirm) {\r\n        try {\r\n          const saveRes = await workApi.saveWork({\r\n            title: res.content || '未命名作品',\r\n            imageUrl: imageUrl.value\r\n          })\r\n          \r\n          if (saveRes.code === 200) {\r\n            uni.showToast({\r\n              title: '保存成功',\r\n              icon: 'success'\r\n            })\r\n            \r\n            setTimeout(() => {\r\n              uni.switchTab({\r\n                url: '/pages/works/list'\r\n              })\r\n            }, 1500)\r\n          }\r\n        } catch (error) {\r\n          uni.showToast({\r\n            title: '保存失败',\r\n            icon: 'none'\r\n          })\r\n        }\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nconst handleApply = async () => {\r\n  // 先保存作品（如果还没保存），获取workId\r\n  // 然后跳转到预览页\r\n  uni.showModal({\r\n    title: '应用到包包',\r\n    content: '需要先保存作品才能应用到包包，是否现在保存？',\r\n    success: async (res) => {\r\n      if (res.confirm) {\r\n        // 先保存作品\r\n        uni.showModal({\r\n          title: '保存作品',\r\n          editable: true,\r\n          placeholderText: '请输入作品标题',\r\n          success: async (saveRes) => {\r\n            if (saveRes.confirm) {\r\n              try {\r\n                uni.showLoading({\r\n                  title: '保存中...'\r\n                })\r\n                \r\n                const saveResult = await workApi.saveWork({\r\n                  title: saveRes.content || '未命名作品',\r\n                  imageUrl: imageUrl.value\r\n                })\r\n                \r\n                uni.hideLoading()\r\n                \r\n                if (saveResult.code === 200 && saveResult.data) {\r\n                  const workId = saveResult.data.id\r\n                  // 跳转到预览页，传递图片URL和workId\r\n                  uni.navigateTo({\r\n                    url: `/pages/preview/preview?workId=${workId}&imageUrl=${encodeURIComponent(imageUrl.value)}`\r\n                  })\r\n                } else {\r\n                  uni.showToast({\r\n                    title: saveResult.message || '保存失败',\r\n                    icon: 'none'\r\n                  })\r\n                }\r\n              } catch (error) {\r\n                uni.hideLoading()\r\n                uni.showToast({\r\n                  title: '保存失败',\r\n                  icon: 'none'\r\n                })\r\n              }\r\n            }\r\n          }\r\n        })\r\n      } else {\r\n        // 用户取消，直接跳转（但可能无法添加到购物车）\r\n        uni.navigateTo({\r\n          url: `/pages/preview/preview?imageUrl=${encodeURIComponent(imageUrl.value)}`\r\n        })\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nconst handleRegenerate = () => {\r\n  uni.navigateBack()\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.result-container {\r\n  min-height: 100vh;\r\n  background-color: #F8F8F8;\r\n}\r\n\r\n.image-section {\r\n  padding: 40rpx;\r\n  background: #ffffff;\r\n  margin-bottom: 20rpx;\r\n  \r\n  .result-image {\r\n    width: 100%;\r\n    min-height: 600rpx;\r\n    border-radius: 20rpx;\r\n  }\r\n}\r\n\r\n.action-section {\r\n  padding: 30rpx 40rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20rpx;\r\n  \r\n  .action-btn {\r\n    width: 100%;\r\n    height: 88rpx;\r\n    border-radius: 44rpx;\r\n    font-size: 32rpx;\r\n    font-weight: bold;\r\n    border: none;\r\n    \r\n    &.save-btn {\r\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n      color: #ffffff;\r\n    }\r\n    \r\n    &.apply-btn {\r\n      background: #007AFF;\r\n      color: #ffffff;\r\n    }\r\n    \r\n    &.regenerate-btn {\r\n      background: #F5F5F5;\r\n      color: #666666;\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n\r\n","import MiniProgramPage from 'D:/code/my-shop-cursor/frontend/pages/generate/result.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onLoad","uni","workApi"],"mappings":";;;;;;AAmBA,UAAM,WAAWA,cAAG,IAAC,EAAE;AACvB,UAAM,SAASA,cAAG,IAAC,IAAI;AAEvBC,kBAAM,OAAC,CAAC,YAAY;AAClB,eAAS,QAAQ,mBAAmB,QAAQ,YAAY,EAAE;AAC1D,aAAO,QAAQ,QAAQ;AAAA,IACzB,CAAC;AAED,UAAM,eAAe,MAAM;AACzBC,oBAAAA,MAAI,aAAa;AAAA,QACf,MAAM,CAAC,SAAS,KAAK;AAAA,QACrB,SAAS,SAAS;AAAA,MACtB,CAAG;AAAA,IACH;AAEA,UAAM,aAAa,YAAY;AAC7BA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,UAAU;AAAA,QACV,iBAAiB;AAAA,QACjB,SAAS,OAAO,QAAQ;AACtB,cAAI,IAAI,SAAS;AACf,gBAAI;AACF,oBAAM,UAAU,MAAMC,SAAO,QAAC,SAAS;AAAA,gBACrC,OAAO,IAAI,WAAW;AAAA,gBACtB,UAAU,SAAS;AAAA,cAC/B,CAAW;AAED,kBAAI,QAAQ,SAAS,KAAK;AACxBD,8BAAAA,MAAI,UAAU;AAAA,kBACZ,OAAO;AAAA,kBACP,MAAM;AAAA,gBACpB,CAAa;AAED,2BAAW,MAAM;AACfA,gCAAAA,MAAI,UAAU;AAAA,oBACZ,KAAK;AAAA,kBACrB,CAAe;AAAA,gBACF,GAAE,IAAI;AAAA,cACR;AAAA,YACF,SAAQ,OAAO;AACdA,4BAAAA,MAAI,UAAU;AAAA,gBACZ,OAAO;AAAA,gBACP,MAAM;AAAA,cAClB,CAAW;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;AAEA,UAAM,cAAc,YAAY;AAG9BA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,OAAO,QAAQ;AACtB,cAAI,IAAI,SAAS;AAEfA,0BAAAA,MAAI,UAAU;AAAA,cACZ,OAAO;AAAA,cACP,UAAU;AAAA,cACV,iBAAiB;AAAA,cACjB,SAAS,OAAO,YAAY;AAC1B,oBAAI,QAAQ,SAAS;AACnB,sBAAI;AACFA,kCAAAA,MAAI,YAAY;AAAA,sBACd,OAAO;AAAA,oBACzB,CAAiB;AAED,0BAAM,aAAa,MAAMC,SAAO,QAAC,SAAS;AAAA,sBACxC,OAAO,QAAQ,WAAW;AAAA,sBAC1B,UAAU,SAAS;AAAA,oBACrC,CAAiB;AAEDD,kCAAAA,MAAI,YAAa;AAEjB,wBAAI,WAAW,SAAS,OAAO,WAAW,MAAM;AAC9C,4BAAM,SAAS,WAAW,KAAK;AAE/BA,oCAAAA,MAAI,WAAW;AAAA,wBACb,KAAK,iCAAiC,MAAM,aAAa,mBAAmB,SAAS,KAAK,CAAC;AAAA,sBAC/G,CAAmB;AAAA,oBACnB,OAAuB;AACLA,oCAAAA,MAAI,UAAU;AAAA,wBACZ,OAAO,WAAW,WAAW;AAAA,wBAC7B,MAAM;AAAA,sBAC1B,CAAmB;AAAA,oBACF;AAAA,kBACF,SAAQ,OAAO;AACdA,kCAAAA,MAAI,YAAa;AACjBA,kCAAAA,MAAI,UAAU;AAAA,sBACZ,OAAO;AAAA,sBACP,MAAM;AAAA,oBACxB,CAAiB;AAAA,kBACF;AAAA,gBACF;AAAA,cACF;AAAA,YACX,CAAS;AAAA,UACT,OAAa;AAELA,0BAAAA,MAAI,WAAW;AAAA,cACb,KAAK,mCAAmC,mBAAmB,SAAS,KAAK,CAAC;AAAA,YACpF,CAAS;AAAA,UACF;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;AAEA,UAAM,mBAAmB,MAAM;AAC7BA,oBAAAA,MAAI,aAAc;AAAA,IACpB;;;;;;;;;;;;;AClIA,GAAG,WAAW,eAAe;"}