{"version":3,"file":"detail.js","sources":["pages/works/detail.vue","../../../software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvd29ya3MvZGV0YWlsLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"detail-container\">\n    <view class=\"image-section\">\n      <image class=\"work-image\" :src=\"work.imageUrl\" mode=\"aspectFit\" @click=\"previewImage\"></image>\n    </view>\n    \n    <view class=\"info-section\">\n      <text class=\"work-title\">{{ work.title }}</text>\n      <text class=\"work-description\" v-if=\"work.description\">{{ work.description }}</text>\n      \n      <view class=\"category-section\">\n        <view class=\"category-title\">分类</view>\n        <view class=\"category-content\">\n          <text class=\"category-value\" v-if=\"work.category\">{{ work.category }}</text>\n          <text class=\"category-placeholder\" v-else>未设置分类</text>\n          <text class=\"category-edit-btn\" @click=\"showCategoryModal\">编辑</text>\n        </view>\n      </view>\n      \n      <view class=\"tags-section\" v-if=\"tags.length > 0 || editingTags\">\n        <view class=\"tags-title\">标签</view>\n        <view class=\"tags-list\">\n          <view \n            class=\"tag-item\" \n            v-for=\"(tag, index) in tags\" \n            :key=\"index\"\n          >\n            <text>{{ tag }}</text>\n            <text class=\"tag-remove\" @click=\"removeTag(tag)\" v-if=\"editingTags\">×</text>\n          </view>\n          <view class=\"tag-item add-tag\" @click=\"showAddTagModal\" v-if=\"editingTags\">\n            <text>+ 添加</text>\n          </view>\n        </view>\n        <view class=\"tags-actions\">\n          <text class=\"tags-edit-btn\" @click=\"toggleEditTags\">\n            {{ editingTags ? '完成' : '编辑标签' }}\n          </text>\n        </view>\n      </view>\n      \n      <text class=\"work-time\">创建时间：{{ formatTime(work.createTime) }}</text>\n    </view>\n    \n    <view class=\"action-section\">\n      <button class=\"action-btn favorite-btn\" :class=\"{ active: work.isFavorite }\" @click=\"handleToggleFavorite\">\n        {{ work.isFavorite ? '⭐ 已收藏' : '☆ 收藏' }}\n      </button>\n      <button class=\"action-btn share-btn\" @click=\"handleShare\">分享作品</button>\n      <button class=\"action-btn apply-btn\" @click=\"handleApply\">应用到包包</button>\n      <button class=\"action-btn delete-btn\" @click=\"handleDelete\">删除作品</button>\n    </view>\n    \n    <!-- 隐藏的Canvas用于生成海报 -->\n    <canvas \n      canvas-id=\"share-poster-canvas\" \n      :style=\"{ width: '750px', height: '1334px', position: 'fixed', left: '-9999px', top: '-9999px' }\"\n    ></canvas>\n  </view>\n</template>\n\n<script setup>\nimport { ref } from 'vue'\nimport { workApi } from '@/api/work'\nimport { onLoad, onShow } from '@dcloudio/uni-app'\nimport { generatePoster, savePosterToAlbum } from '@/utils/poster'\n\nconst work = ref({})\nconst workId = ref(null)\nconst tags = ref([])\nconst editingTags = ref(false)\nconst allCategories = ref([]) // 所有分类列表\n\nonLoad(async (options) => {\n  workId.value = options.id\n  await loadWorkDetail()\n  // 不在页面加载时加载分类列表，避免超时\n  // 分类列表将在用户点击\"编辑分类\"时按需加载\n})\n\nconst loadWorkDetail = async () => {\n  try {\n    const res = await workApi.getWorkDetail(workId.value)\n    if (res.code === 200 && res.data) {\n      work.value = res.data\n      // 解析tags JSON字符串\n      if (work.value.tags) {\n        try {\n          tags.value = JSON.parse(work.value.tags)\n        } catch (e) {\n          tags.value = []\n        }\n      } else {\n        tags.value = []\n      }\n    }\n  } catch (error) {\n    console.error('加载作品详情失败', error)\n  }\n}\n\n// 加载所有分类（与作品集页面使用相同的数据源）\n// 优化：使用分页加载，避免一次性加载过多数据\nconst loadAllCategories = async () => {\n  try {\n    const catSet = new Set()\n    let page = 0\n    const size = 50 // 每次加载50条，减少单次请求数据量\n    let hasMore = true\n    \n    // 分页加载所有作品以提取分类\n    while (hasMore) {\n      const res = await workApi.getWorks({ page, size })\n      if (res.code === 200 && res.data) {\n        const worksList = res.data.content || []\n        worksList.forEach(w => {\n          if (w.category) {\n            catSet.add(w.category)\n          }\n        })\n        \n        // 检查是否还有更多数据\n        hasMore = !res.data.last && worksList.length === size\n        page++\n      } else {\n        hasMore = false\n      }\n    }\n    \n    allCategories.value = Array.from(catSet).sort()\n    console.log('加载所有分类:', allCategories.value)\n  } catch (error) {\n    console.error('加载分类列表失败', error)\n    throw error // 抛出错误，让调用方处理\n  }\n}\n\nconst toggleEditTags = () => {\n  editingTags.value = !editingTags.value\n}\n\nconst showCategoryModal = async () => {\n  // 如果分类列表为空，先加载分类列表\n  if (allCategories.value.length === 0) {\n    uni.showLoading({ title: '加载分类中...' })\n    try {\n      await loadAllCategories()\n    } catch (error) {\n      console.error('加载分类列表失败', error)\n      uni.hideLoading()\n      uni.showToast({\n        title: '加载分类失败',\n        icon: 'none'\n      })\n      return\n    }\n    uni.hideLoading()\n  }\n  \n  // 构建操作列表：已有分类 + 自定义分类 + 清除分类\n  const actionList = [...allCategories.value]\n  actionList.push('+ 自定义分类')\n  if (work.value.category) {\n    actionList.push('清除分类')\n  }\n  \n  uni.showActionSheet({\n    itemList: actionList,\n    success: async (res) => {\n      const selectedIndex = res.tapIndex\n      let newCategory = null\n      \n      // 如果选择的是已有分类\n      if (selectedIndex < allCategories.value.length) {\n        newCategory = allCategories.value[selectedIndex]\n      } \n      // 如果选择的是\"自定义分类\"\n      else if (actionList[selectedIndex] === '+ 自定义分类') {\n        // 弹出输入框\n        uni.showModal({\n          title: '自定义分类',\n          editable: true,\n          placeholderText: '请输入分类名称',\n          success: async (modalRes) => {\n            if (modalRes.confirm && modalRes.content && modalRes.content.trim()) {\n              const customCategory = modalRes.content.trim()\n              await updateCategory(customCategory)\n            }\n          }\n        })\n        return\n      }\n      // 如果选择的是\"清除分类\"\n      else if (actionList[selectedIndex] === '清除分类') {\n        newCategory = null\n      }\n      \n      if (newCategory !== undefined) {\n        await updateCategory(newCategory)\n      }\n    }\n  })\n}\n\nconst updateCategory = async (category) => {\n  try {\n    const updateRes = await workApi.updateCategory(workId.value, category)\n    if (updateRes.code === 200 && updateRes.data) {\n      work.value = updateRes.data\n      \n      // 重新加载所有分类，确保与作品集页面数据一致\n      await loadAllCategories()\n      \n      uni.showToast({\n        title: category ? '分类设置成功' : '分类已清除',\n        icon: 'success',\n        duration: 1000\n      })\n    } else {\n      uni.showToast({\n        title: updateRes.message || '设置分类失败',\n        icon: 'none'\n      })\n    }\n  } catch (error) {\n    console.error('设置分类失败', error)\n    uni.showToast({\n      title: '设置分类失败',\n      icon: 'none'\n    })\n  }\n}\n\nonShow(() => {\n  // 从其他页面返回时，重新加载作品详情（分类列表按需加载）\n  if (workId.value) {\n    loadWorkDetail()\n  }\n})\n\nconst showAddTagModal = () => {\n  uni.showModal({\n    title: '添加标签',\n    editable: true,\n    placeholderText: '请输入标签名称',\n    success: async (res) => {\n      if (res.confirm && res.content && res.content.trim()) {\n        const newTag = res.content.trim()\n        if (!tags.value.includes(newTag)) {\n          try {\n            const addRes = await workApi.addTag(workId.value, newTag)\n            if (addRes.code === 200) {\n              tags.value.push(newTag)\n              work.value = addRes.data\n            }\n          } catch (error) {\n            uni.showToast({\n              title: '添加标签失败',\n              icon: 'none'\n            })\n          }\n        } else {\n          uni.showToast({\n            title: '标签已存在',\n            icon: 'none'\n          })\n        }\n      }\n    }\n  })\n}\n\nconst removeTag = async (tag) => {\n  try {\n    const res = await workApi.removeTag(workId.value, tag)\n    if (res.code === 200) {\n      tags.value = tags.value.filter(t => t !== tag)\n      work.value = res.data\n    }\n  } catch (error) {\n    uni.showToast({\n      title: '删除标签失败',\n      icon: 'none'\n    })\n  }\n}\n\nconst previewImage = () => {\n  uni.previewImage({\n    urls: [work.value.imageUrl],\n    current: work.value.imageUrl\n  })\n}\n\nconst handleApply = () => {\n  uni.navigateTo({\n    url: `/pages/preview/preview?workId=${workId.value}&imageUrl=${encodeURIComponent(work.value.imageUrl)}`\n  })\n}\n\nconst handleToggleFavorite = async () => {\n  try {\n    const res = await workApi.toggleFavorite(workId.value)\n    if (res.code === 200 && res.data) {\n      work.value.isFavorite = res.data.isFavorite\n      uni.showToast({\n        title: work.value.isFavorite ? '已收藏' : '已取消收藏',\n        icon: 'success',\n        duration: 1000\n      })\n    }\n  } catch (error) {\n    uni.showToast({\n      title: '操作失败',\n      icon: 'none'\n    })\n  }\n}\n\nconst handleDelete = () => {\n  uni.showModal({\n    title: '确认删除',\n    content: '确定要删除这个作品吗？',\n    success: async (res) => {\n      if (res.confirm) {\n        try {\n          uni.showLoading({\n            title: '删除中...'\n          })\n          \n          const deleteRes = await workApi.deleteWork(workId.value)\n          \n          uni.hideLoading()\n          \n          if (deleteRes.code === 200) {\n            uni.showToast({\n              title: '删除成功',\n              icon: 'success',\n              duration: 1500\n            })\n            \n            // 通知作品列表页面刷新数据\n            // 使用 getApp().globalData 或 uni.$emit 传递删除事件\n            const app = getApp()\n            if (app && app.globalData) {\n              app.globalData.workDeleted = true\n              app.globalData.deletedWorkId = workId.value\n            }\n            \n            // 延迟返回，确保提示显示\n            setTimeout(() => {\n              uni.navigateBack({\n                delta: 1\n              })\n            }, 1500)\n          } else {\n            uni.showToast({\n              title: deleteRes.message || '删除失败',\n              icon: 'none'\n            })\n          }\n        } catch (error) {\n          uni.hideLoading()\n          console.error('删除作品失败', error)\n          uni.showToast({\n            title: '删除失败',\n            icon: 'none'\n          })\n        }\n      }\n    }\n  })\n}\n\nconst handleShare = () => {\n  uni.showActionSheet({\n    itemList: ['分享到微信好友', '分享到朋友圈', '生成分享海报', '保存海报到相册'],\n    success: async (res) => {\n      if (res.tapIndex === 0) {\n        // 分享到微信好友\n        shareToWeChat('session')\n      } else if (res.tapIndex === 1) {\n        // 分享到朋友圈\n        shareToWeChat('timeline')\n      } else if (res.tapIndex === 2) {\n        // 生成分享海报\n        await generateSharePoster()\n      } else if (res.tapIndex === 3) {\n        // 保存海报到相册\n        await saveSharePoster()\n      }\n    }\n  })\n}\n\nconst shareToWeChat = (scene) => {\n  // 微信分享配置\n  const shareUrl = `/pages/works/detail?id=${workId.value}`\n  const shareTitle = work.value.title || '我的AI作品'\n  const shareImageUrl = work.value.imageUrl\n  \n  // 调用微信分享API\n  // 注意：需要在页面onLoad时设置分享配置\n  uni.showShareMenu({\n    withShareTicket: true,\n    menus: ['shareAppMessage', 'shareTimeline']\n  })\n  \n  // 设置分享内容\n  if (scene === 'session') {\n    // 分享给好友\n    uni.shareAppMessage({\n      title: shareTitle,\n      path: shareUrl,\n      imageUrl: shareImageUrl\n    })\n  } else if (scene === 'timeline') {\n    // 分享到朋友圈\n    uni.shareTimeline({\n      title: shareTitle,\n      imageUrl: shareImageUrl\n    })\n  }\n}\n\nconst generateSharePoster = async () => {\n  uni.showLoading({\n    title: '生成中...'\n  })\n  \n  try {\n    const shareUrl = `https://your-domain.com/pages/works/detail?id=${workId.value}`\n    const posterPath = await generatePoster({\n      imageUrl: work.value.imageUrl,\n      title: work.value.title || '我的AI作品',\n      shareUrl: shareUrl\n    })\n    \n    uni.hideLoading()\n    \n    // 预览海报\n    uni.previewImage({\n      urls: [posterPath],\n      current: posterPath\n    })\n  } catch (error) {\n    uni.hideLoading()\n    console.error('生成海报失败', error)\n    uni.showToast({\n      title: '生成失败',\n      icon: 'none'\n    })\n  }\n}\n\nconst saveSharePoster = async () => {\n  uni.showLoading({\n    title: '生成中...'\n  })\n  \n  try {\n    const shareUrl = `https://your-domain.com/pages/works/detail?id=${workId.value}`\n    const posterPath = await generatePoster({\n      imageUrl: work.value.imageUrl,\n      title: work.value.title || '我的AI作品',\n      shareUrl: shareUrl\n    })\n    \n    await savePosterToAlbum(posterPath)\n  } catch (error) {\n    console.error('保存海报失败', error)\n    uni.showToast({\n      title: '保存失败',\n      icon: 'none'\n    })\n  } finally {\n    uni.hideLoading()\n  }\n}\n\nconst formatTime = (timeStr) => {\n  if (!timeStr) return ''\n  const date = new Date(timeStr)\n  return date.toLocaleString('zh-CN')\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.detail-container {\n  min-height: 100vh;\n  background-color: #F8F8F8;\n}\n\n.image-section {\n  background: #ffffff;\n  padding: 40rpx;\n  margin-bottom: 20rpx;\n  \n  .work-image {\n    width: 100%;\n    min-height: 600rpx;\n    border-radius: 20rpx;\n  }\n}\n\n.info-section {\n  background: #ffffff;\n  padding: 40rpx;\n  margin-bottom: 20rpx;\n  \n  .work-title {\n    display: block;\n    font-size: 40rpx;\n    font-weight: bold;\n    color: #333333;\n    margin-bottom: 20rpx;\n  }\n  \n  .work-description {\n    display: block;\n    font-size: 28rpx;\n    color: #666666;\n    line-height: 1.6;\n    margin-bottom: 20rpx;\n  }\n  \n  .work-time {\n    display: block;\n    font-size: 24rpx;\n    color: #999999;\n  }\n  \n  .category-section {\n    margin: 30rpx 0;\n    padding-top: 30rpx;\n    border-top: 1rpx solid #E5E5E5;\n    \n    .category-title {\n      font-size: 28rpx;\n      font-weight: bold;\n      color: #333333;\n      margin-bottom: 20rpx;\n    }\n    \n    .category-content {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      \n      .category-value {\n        font-size: 28rpx;\n        color: #333333;\n        padding: 10rpx 20rpx;\n        background: #F0F0F0;\n        border-radius: 20rpx;\n      }\n      \n      .category-placeholder {\n        font-size: 28rpx;\n        color: #999999;\n        font-style: italic;\n      }\n      \n      .category-edit-btn {\n        font-size: 26rpx;\n        color: #007AFF;\n        padding: 10rpx 20rpx;\n        background: #E8F4FD;\n        border-radius: 20rpx;\n      }\n    }\n  }\n  \n  .tags-section {\n    margin: 30rpx 0;\n    padding-top: 30rpx;\n    border-top: 1rpx solid #E5E5E5;\n    \n    .tags-title {\n      font-size: 28rpx;\n      font-weight: bold;\n      color: #333333;\n      margin-bottom: 20rpx;\n    }\n    \n    .tags-list {\n      display: flex;\n      flex-wrap: wrap;\n      gap: 15rpx;\n      margin-bottom: 20rpx;\n      \n      .tag-item {\n        display: inline-flex;\n        align-items: center;\n        padding: 8rpx 20rpx;\n        background: #F0F0F0;\n        border-radius: 20rpx;\n        font-size: 24rpx;\n        color: #666666;\n        \n        .tag-remove {\n          margin-left: 10rpx;\n          font-size: 32rpx;\n          color: #FF3B30;\n          font-weight: bold;\n        }\n        \n        &.add-tag {\n          background: #E8F4FD;\n          color: #007AFF;\n          border: 1rpx dashed #007AFF;\n        }\n      }\n    }\n    \n    .tags-actions {\n      .tags-edit-btn {\n        font-size: 26rpx;\n        color: #007AFF;\n      }\n    }\n  }\n}\n\n.action-section {\n  padding: 30rpx 40rpx;\n  display: flex;\n  flex-direction: column;\n  gap: 20rpx;\n  \n  .action-btn {\n    width: 100%;\n    height: 88rpx;\n    border-radius: 44rpx;\n    font-size: 32rpx;\n    font-weight: bold;\n    border: none;\n    \n    &.apply-btn {\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      color: #ffffff;\n    }\n    \n    &.delete-btn {\n      background: #FF3B30;\n      color: #ffffff;\n    }\n    \n    &.favorite-btn {\n      background: #F5F5F5;\n      color: #666666;\n      \n      &.active {\n        background: linear-gradient(135deg, #FF9500 0%, #FF6B00 100%);\n        color: #ffffff;\n      }\n    }\n    \n    &.share-btn {\n      background: linear-gradient(135deg, #34C759 0%, #30D158 100%);\n      color: #ffffff;\n    }\n  }\n}\n</style>\n\n\n","import MiniProgramPage from 'D:/code/my-shop-cursor/frontend/pages/works/detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onLoad","workApi","uni","onShow","generatePoster","savePosterToAlbum"],"mappings":"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"}