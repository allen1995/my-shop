{"version":3,"file":"list.js","sources":["pages/works/list.vue","../../../software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvd29ya3MvbGlzdC52dWU"],"sourcesContent":["<template>\r\n  <view class=\"works-container\">\r\n    <view class=\"works-grid\" v-if=\"works.length > 0\">\r\n      <view \r\n        class=\"work-card\" \r\n        v-for=\"work in works\" \r\n        :key=\"work.id\"\r\n        @click=\"goToDetail(work.id)\"\r\n      >\r\n        <image class=\"work-image\" :src=\"work.imageUrl\" mode=\"aspectFill\"></image>\r\n        <view class=\"work-info\">\r\n          <text class=\"work-title\">{{ work.title }}</text>\r\n          <text class=\"work-time\">{{ formatTime(work.createTime) }}</text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    \r\n    <view class=\"empty-state\" v-else>\r\n      <image class=\"empty-icon\" src=\"/static/icons/empty.png\" mode=\"aspectFit\"></image>\r\n      <text class=\"empty-text\">还没有作品，快去生成吧~</text>\r\n      <button class=\"empty-btn\" @click=\"goToGenerate\">去生成</button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { workApi } from '@/api/work'\r\nimport { onPullDownRefresh, onReachBottom } from '@dcloudio/uni-app'\r\n\r\nconst works = ref([])\r\nconst page = ref(0)\r\nconst size = ref(20)\r\nconst loading = ref(false)\r\nconst hasMore = ref(true)\r\n\r\nconst loadWorks = async (reset = false) => {\r\n  if (loading.value) return\r\n  \r\n  loading.value = true\r\n  \r\n  try {\r\n    if (reset) {\r\n      page.value = 0\r\n      works.value = []\r\n    }\r\n    \r\n    const res = await workApi.getWorks({\r\n      page: page.value,\r\n      size: size.value\r\n    })\r\n    \r\n    if (res.code === 200 && res.data) {\r\n      const newWorks = res.data.content || []\r\n      works.value = reset ? newWorks : [...works.value, ...newWorks]\r\n      hasMore.value = newWorks.length === size.value\r\n      page.value++\r\n    }\r\n  } catch (error) {\r\n    console.error('加载作品失败', error)\r\n  } finally {\r\n    loading.value = false\r\n    uni.stopPullDownRefresh()\r\n  }\r\n}\r\n\r\nconst goToDetail = (workId) => {\r\n  uni.navigateTo({\r\n    url: `/pages/works/detail?id=${workId}`\r\n  })\r\n}\r\n\r\nconst goToGenerate = () => {\r\n  uni.switchTab({\r\n    url: '/pages/index/index'\r\n  })\r\n}\r\n\r\nconst formatTime = (timeStr) => {\r\n  if (!timeStr) return ''\r\n  const date = new Date(timeStr)\r\n  const now = new Date()\r\n  const diff = now - date\r\n  \r\n  if (diff < 60000) return '刚刚'\r\n  if (diff < 3600000) return Math.floor(diff / 60000) + '分钟前'\r\n  if (diff < 86400000) return Math.floor(diff / 3600000) + '小时前'\r\n  return Math.floor(diff / 86400000) + '天前'\r\n}\r\n\r\nonMounted(() => {\r\n  loadWorks(true)\r\n})\r\n\r\nonPullDownRefresh(() => {\r\n  loadWorks(true)\r\n})\r\n\r\nonReachBottom(() => {\r\n  if (hasMore.value) {\r\n    loadWorks()\r\n  }\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.works-container {\r\n  padding: 20rpx;\r\n  min-height: 100vh;\r\n  background-color: #F8F8F8;\r\n}\r\n\r\n.works-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(2, 1fr);\r\n  gap: 20rpx;\r\n  \r\n  .work-card {\r\n    background: #ffffff;\r\n    border-radius: 20rpx;\r\n    overflow: hidden;\r\n    box-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.1);\r\n    \r\n    .work-image {\r\n      width: 100%;\r\n      height: 300rpx;\r\n    }\r\n    \r\n    .work-info {\r\n      padding: 20rpx;\r\n      \r\n      .work-title {\r\n        display: block;\r\n        font-size: 28rpx;\r\n        font-weight: bold;\r\n        color: #333333;\r\n        margin-bottom: 10rpx;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n      }\r\n      \r\n      .work-time {\r\n        display: block;\r\n        font-size: 24rpx;\r\n        color: #999999;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.empty-state {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 200rpx 40rpx;\r\n  \r\n  .empty-icon {\r\n    width: 200rpx;\r\n    height: 200rpx;\r\n    margin-bottom: 40rpx;\r\n    opacity: 0.5;\r\n  }\r\n  \r\n  .empty-text {\r\n    font-size: 32rpx;\r\n    color: #999999;\r\n    margin-bottom: 40rpx;\r\n  }\r\n  \r\n  .empty-btn {\r\n    padding: 20rpx 60rpx;\r\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n    color: #ffffff;\r\n    border-radius: 44rpx;\r\n    font-size: 28rpx;\r\n    border: none;\r\n  }\r\n}\r\n</style>\r\n\r\n\r\n","import MiniProgramPage from 'D:/code/my-shop-cursor/frontend/pages/works/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","workApi","uni","onMounted","onPullDownRefresh","onReachBottom"],"mappings":";;;;;;;AA8BA,UAAM,QAAQA,cAAG,IAAC,EAAE;AACpB,UAAM,OAAOA,cAAG,IAAC,CAAC;AAClB,UAAM,OAAOA,cAAG,IAAC,EAAE;AACnB,UAAM,UAAUA,cAAG,IAAC,KAAK;AACzB,UAAM,UAAUA,cAAG,IAAC,IAAI;AAExB,UAAM,YAAY,OAAO,QAAQ,UAAU;AACzC,UAAI,QAAQ;AAAO;AAEnB,cAAQ,QAAQ;AAEhB,UAAI;AACF,YAAI,OAAO;AACT,eAAK,QAAQ;AACb,gBAAM,QAAQ,CAAE;AAAA,QACjB;AAED,cAAM,MAAM,MAAMC,SAAO,QAAC,SAAS;AAAA,UACjC,MAAM,KAAK;AAAA,UACX,MAAM,KAAK;AAAA,QACjB,CAAK;AAED,YAAI,IAAI,SAAS,OAAO,IAAI,MAAM;AAChC,gBAAM,WAAW,IAAI,KAAK,WAAW,CAAE;AACvC,gBAAM,QAAQ,QAAQ,WAAW,CAAC,GAAG,MAAM,OAAO,GAAG,QAAQ;AAC7D,kBAAQ,QAAQ,SAAS,WAAW,KAAK;AACzC,eAAK;AAAA,QACN;AAAA,MACF,SAAQ,OAAO;AACdC,sBAAAA,MAAA,MAAA,SAAA,8BAAc,UAAU,KAAK;AAAA,MACjC,UAAY;AACR,gBAAQ,QAAQ;AAChBA,sBAAAA,MAAI,oBAAqB;AAAA,MAC1B;AAAA,IACH;AAEA,UAAM,aAAa,CAAC,WAAW;AAC7BA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,0BAA0B,MAAM;AAAA,MACzC,CAAG;AAAA,IACH;AAEA,UAAM,eAAe,MAAM;AACzBA,oBAAAA,MAAI,UAAU;AAAA,QACZ,KAAK;AAAA,MACT,CAAG;AAAA,IACH;AAEA,UAAM,aAAa,CAAC,YAAY;AAC9B,UAAI,CAAC;AAAS,eAAO;AACrB,YAAM,OAAO,IAAI,KAAK,OAAO;AAC7B,YAAM,MAAM,oBAAI,KAAM;AACtB,YAAM,OAAO,MAAM;AAEnB,UAAI,OAAO;AAAO,eAAO;AACzB,UAAI,OAAO;AAAS,eAAO,KAAK,MAAM,OAAO,GAAK,IAAI;AACtD,UAAI,OAAO;AAAU,eAAO,KAAK,MAAM,OAAO,IAAO,IAAI;AACzD,aAAO,KAAK,MAAM,OAAO,KAAQ,IAAI;AAAA,IACvC;AAEAC,kBAAAA,UAAU,MAAM;AACd,gBAAU,IAAI;AAAA,IAChB,CAAC;AAEDC,kBAAAA,kBAAkB,MAAM;AACtB,gBAAU,IAAI;AAAA,IAChB,CAAC;AAEDC,kBAAAA,cAAc,MAAM;AAClB,UAAI,QAAQ,OAAO;AACjB,kBAAW;AAAA,MACZ;AAAA,IACH,CAAC;;;;;;;;;;;;;;;;;;;;;;ACrGD,GAAG,WAAW,eAAe;"}