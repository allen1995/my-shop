{"version":3,"file":"list.js","sources":["pages/order/list.vue","../../../software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvb3JkZXIvbGlzdC52dWU"],"sourcesContent":["<template>\r\n  <view class=\"order-list-container\">\r\n    <view class=\"status-tabs\">\r\n      <view \r\n        class=\"status-tab\" \r\n        :class=\"{ active: selectedStatus === null }\"\r\n        @click=\"selectStatus(null)\"\r\n      >\r\n        <text>全部</text>\r\n      </view>\r\n      <view \r\n        class=\"status-tab\" \r\n        v-for=\"status in statusOptions\" \r\n        :key=\"status.value\"\r\n        :class=\"{ active: selectedStatus === status.value }\"\r\n        @click=\"selectStatus(status.value)\"\r\n      >\r\n        <text>{{ status.label }}</text>\r\n      </view>\r\n    </view>\r\n    \r\n    <view class=\"orders-list\" v-if=\"orders.length > 0\">\r\n      <view \r\n        class=\"order-card\" \r\n        v-for=\"order in orders\" \r\n        :key=\"order.id\"\r\n        @click=\"goToDetail(order.id)\"\r\n      >\r\n        <view class=\"order-header\">\r\n          <text class=\"order-no\">订单号：{{ order.orderNo }}</text>\r\n          <text class=\"order-status\" :class=\"getStatusClass(order.status)\">\r\n            {{ getStatusText(order.status) }}\r\n          </text>\r\n        </view>\r\n        \r\n        <view class=\"order-items\">\r\n          <view \r\n            class=\"order-item\" \r\n            v-for=\"(item, index) in order.items\" \r\n            :key=\"index\"\r\n          >\r\n            <image \r\n              v-if=\"item.previewImageUrl\" \r\n              class=\"item-image\" \r\n              :src=\"item.previewImageUrl\" \r\n              mode=\"aspectFill\"\r\n            ></image>\r\n            <view class=\"item-info\">\r\n              <text class=\"item-desc\">{{ item.color }} {{ item.size }} x{{ item.quantity }}</text>\r\n              <text class=\"item-price\">¥{{ item.price }}</text>\r\n            </view>\r\n          </view>\r\n        </view>\r\n        \r\n        <view class=\"order-footer\">\r\n          <text class=\"order-time\">{{ formatTime(order.createTime) }}</text>\r\n          <text class=\"order-total\">合计：¥{{ order.totalAmount }}</text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    \r\n    <view class=\"empty-state\" v-else>\r\n      <text class=\"empty-text\">暂无订单</text>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { orderApi } from '@/api/order'\r\nimport { onPullDownRefresh, onReachBottom } from '@dcloudio/uni-app'\r\n\r\nconst orders = ref([])\r\nconst page = ref(0)\r\nconst size = ref(20)\r\nconst loading = ref(false)\r\nconst hasMore = ref(true)\r\nconst selectedStatus = ref(null)\r\n\r\nconst statusOptions = [\r\n  { label: '待支付', value: 'PENDING_PAYMENT' },\r\n  { label: '待发货', value: 'PROCESSING' },\r\n  { label: '待收货', value: 'SHIPPED' },\r\n  { label: '已完成', value: 'COMPLETED' }\r\n]\r\n\r\nconst loadOrders = async (reset = false) => {\r\n  if (loading.value) return\r\n  \r\n  loading.value = true\r\n  \r\n  try {\r\n    if (reset) {\r\n      page.value = 0\r\n      orders.value = []\r\n    }\r\n    \r\n    const params = {\r\n      page: page.value,\r\n      size: size.value\r\n    }\r\n    \r\n    if (selectedStatus.value) {\r\n      params.status = selectedStatus.value\r\n    }\r\n    \r\n    const res = await orderApi.getOrders(params)\r\n    \r\n    if (res.code === 200 && res.data) {\r\n      const newOrders = res.data.content || []\r\n      orders.value = reset ? newOrders : [...orders.value, ...newOrders]\r\n      hasMore.value = newOrders.length === size.value\r\n      page.value++\r\n    }\r\n  } catch (error) {\r\n    console.error('加载订单失败', error)\r\n  } finally {\r\n    loading.value = false\r\n    uni.stopPullDownRefresh()\r\n  }\r\n}\r\n\r\nconst selectStatus = (status) => {\r\n  selectedStatus.value = status\r\n  loadOrders(true)\r\n}\r\n\r\nconst goToDetail = (orderId) => {\r\n  uni.navigateTo({\r\n    url: `/pages/order/detail?id=${orderId}`\r\n  })\r\n}\r\n\r\nconst getStatusText = (status) => {\r\n  const statusMap = {\r\n    'PENDING_PAYMENT': '待支付',\r\n    'PAID': '已支付',\r\n    'PROCESSING': '待发货',\r\n    'SHIPPED': '待收货',\r\n    'COMPLETED': '已完成',\r\n    'CANCELLED': '已取消'\r\n  }\r\n  return statusMap[status] || status\r\n}\r\n\r\nconst getStatusClass = (status) => {\r\n  const classMap = {\r\n    'PENDING_PAYMENT': 'status-pending',\r\n    'PAID': 'status-paid',\r\n    'PROCESSING': 'status-processing',\r\n    'SHIPPED': 'status-shipped',\r\n    'COMPLETED': 'status-completed',\r\n    'CANCELLED': 'status-cancelled'\r\n  }\r\n  return classMap[status] || ''\r\n}\r\n\r\nconst formatTime = (timeStr) => {\r\n  if (!timeStr) return ''\r\n  const date = new Date(timeStr)\r\n  return date.toLocaleString('zh-CN', {\r\n    year: 'numeric',\r\n    month: '2-digit',\r\n    day: '2-digit',\r\n    hour: '2-digit',\r\n    minute: '2-digit'\r\n  })\r\n}\r\n\r\nonMounted(() => {\r\n  loadOrders(true)\r\n})\r\n\r\nonPullDownRefresh(() => {\r\n  loadOrders(true)\r\n})\r\n\r\nonReachBottom(() => {\r\n  if (hasMore.value) {\r\n    loadOrders()\r\n  }\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.order-list-container {\r\n  min-height: 100vh;\r\n  background-color: #F8F8F8;\r\n  padding-bottom: 20rpx;\r\n}\r\n\r\n.status-tabs {\r\n  background: #ffffff;\r\n  padding: 20rpx;\r\n  display: flex;\r\n  gap: 15rpx;\r\n  overflow-x: auto;\r\n  white-space: nowrap;\r\n  margin-bottom: 20rpx;\r\n  \r\n  .status-tab {\r\n    padding: 10rpx 30rpx;\r\n    background: #F5F5F5;\r\n    border-radius: 30rpx;\r\n    font-size: 26rpx;\r\n    color: #666666;\r\n    transition: all 0.3s;\r\n    flex-shrink: 0;\r\n    \r\n    &.active {\r\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n      color: #ffffff;\r\n    }\r\n    \r\n    text {\r\n      display: block;\r\n    }\r\n  }\r\n}\r\n\r\n.orders-list {\r\n  padding: 0 20rpx;\r\n  \r\n  .order-card {\r\n    background: #ffffff;\r\n    border-radius: 20rpx;\r\n    padding: 30rpx;\r\n    margin-bottom: 20rpx;\r\n    box-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.05);\r\n    \r\n    .order-header {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n      margin-bottom: 20rpx;\r\n      padding-bottom: 20rpx;\r\n      border-bottom: 1rpx solid #E5E5E5;\r\n      \r\n      .order-no {\r\n        font-size: 26rpx;\r\n        color: #666666;\r\n      }\r\n      \r\n      .order-status {\r\n        font-size: 26rpx;\r\n        font-weight: bold;\r\n        \r\n        &.status-pending {\r\n          color: #FF9500;\r\n        }\r\n        \r\n        &.status-paid {\r\n          color: #007AFF;\r\n        }\r\n        \r\n        &.status-processing {\r\n          color: #5AC8FA;\r\n        }\r\n        \r\n        &.status-shipped {\r\n          color: #34C759;\r\n        }\r\n        \r\n        &.status-completed {\r\n          color: #34C759;\r\n        }\r\n        \r\n        &.status-cancelled {\r\n          color: #999999;\r\n        }\r\n      }\r\n    }\r\n    \r\n    .order-items {\r\n      margin-bottom: 20rpx;\r\n      \r\n      .order-item {\r\n        display: flex;\r\n        align-items: center;\r\n        margin-bottom: 15rpx;\r\n        \r\n        .item-image {\r\n          width: 120rpx;\r\n          height: 120rpx;\r\n          border-radius: 10rpx;\r\n          margin-right: 20rpx;\r\n        }\r\n        \r\n        .item-info {\r\n          flex: 1;\r\n          display: flex;\r\n          justify-content: space-between;\r\n          align-items: center;\r\n          \r\n          .item-desc {\r\n            font-size: 28rpx;\r\n            color: #333333;\r\n          }\r\n          \r\n          .item-price {\r\n            font-size: 28rpx;\r\n            font-weight: bold;\r\n            color: #FF3B30;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    .order-footer {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n      padding-top: 20rpx;\r\n      border-top: 1rpx solid #E5E5E5;\r\n      \r\n      .order-time {\r\n        font-size: 24rpx;\r\n        color: #999999;\r\n      }\r\n      \r\n      .order-total {\r\n        font-size: 32rpx;\r\n        font-weight: bold;\r\n        color: #FF3B30;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.empty-state {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  padding: 200rpx 40rpx;\r\n  \r\n  .empty-text {\r\n    font-size: 32rpx;\r\n    color: #999999;\r\n  }\r\n}\r\n</style>\r\n\r\n","import MiniProgramPage from 'D:/code/my-shop-cursor/frontend/pages/order/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","orderApi","uni","onMounted","onPullDownRefresh","onReachBottom"],"mappings":"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"}