{"version":3,"file":"detail.js","sources":["pages/order/detail.vue","../../../software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvb3JkZXIvZGV0YWlsLnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"detail-container\">\r\n    <view class=\"status-section\">\r\n      <view class=\"status-info\">\r\n        <text class=\"status-text\" :class=\"getStatusClass(order.status)\">\r\n          {{ getStatusText(order.status) }}\r\n        </text>\r\n        <text class=\"status-desc\">{{ getStatusDesc(order.status) }}</text>\r\n      </view>\r\n      \r\n      <view class=\"status-timeline\" v-if=\"order.status !== 'PENDING_PAYMENT'\">\r\n        <view class=\"timeline-item\" :class=\"{ active: isStatusReached('PENDING_PAYMENT') }\">\r\n          <view class=\"timeline-dot\"></view>\r\n          <text class=\"timeline-text\">待支付</text>\r\n        </view>\r\n        <view class=\"timeline-item\" :class=\"{ active: isStatusReached('PAID') || isStatusReached('PROCESSING') }\">\r\n          <view class=\"timeline-dot\"></view>\r\n          <text class=\"timeline-text\">已支付</text>\r\n        </view>\r\n        <view class=\"timeline-item\" :class=\"{ active: isStatusReached('PROCESSING') || isStatusReached('SHIPPED') }\">\r\n          <view class=\"timeline-dot\"></view>\r\n          <text class=\"timeline-text\">待发货</text>\r\n        </view>\r\n        <view class=\"timeline-item\" :class=\"{ active: isStatusReached('SHIPPED') || isStatusReached('COMPLETED') }\">\r\n          <view class=\"timeline-dot\"></view>\r\n          <text class=\"timeline-text\">待收货</text>\r\n        </view>\r\n        <view class=\"timeline-item\" :class=\"{ active: isStatusReached('COMPLETED') }\">\r\n          <view class=\"timeline-dot\"></view>\r\n          <text class=\"timeline-text\">已完成</text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    \r\n    <view class=\"order-info-section\">\r\n      <view class=\"section-title\">订单信息</view>\r\n      <view class=\"info-item\">\r\n        <text class=\"info-label\">订单号</text>\r\n        <text class=\"info-value\">{{ order.orderNo }}</text>\r\n      </view>\r\n      <view class=\"info-item\">\r\n        <text class=\"info-label\">创建时间</text>\r\n        <text class=\"info-value\">{{ formatTime(order.createTime) }}</text>\r\n      </view>\r\n      <view class=\"info-item\" v-if=\"order.paymentTime\">\r\n        <text class=\"info-label\">支付时间</text>\r\n        <text class=\"info-value\">{{ formatTime(order.paymentTime) }}</text>\r\n      </view>\r\n    </view>\r\n    \r\n    <view class=\"items-section\">\r\n      <view class=\"section-title\">商品信息</view>\r\n      <view \r\n        class=\"item-card\" \r\n        v-for=\"(item, index) in order.items\" \r\n        :key=\"index\"\r\n      >\r\n        <image \r\n          v-if=\"item.previewImageUrl\" \r\n          class=\"item-image\" \r\n          :src=\"item.previewImageUrl\" \r\n          mode=\"aspectFill\"\r\n        ></image>\r\n        <view class=\"item-info\">\r\n          <text class=\"item-spec\">{{ item.color }} {{ item.size }}</text>\r\n          <text class=\"item-quantity\">数量：{{ item.quantity }}</text>\r\n          <text class=\"item-price\">¥{{ item.price }}</text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    \r\n    <view class=\"amount-section\">\r\n      <view class=\"section-title\">费用明细</view>\r\n      <view class=\"amount-item\">\r\n        <text class=\"amount-label\">商品总额</text>\r\n        <text class=\"amount-value\">¥{{ order.totalAmount }}</text>\r\n      </view>\r\n      <view class=\"amount-total\">\r\n        <text class=\"total-label\">实付金额</text>\r\n        <text class=\"total-value\">¥{{ order.totalAmount }}</text>\r\n      </view>\r\n    </view>\r\n    \r\n    <view class=\"action-section\">\r\n      <button \r\n        v-if=\"order.status === 'PENDING_PAYMENT'\" \r\n        class=\"action-btn cancel-btn\" \r\n        @click=\"handleCancel\"\r\n      >\r\n        取消订单\r\n      </button>\r\n      <button \r\n        v-if=\"order.status === 'SHIPPED'\" \r\n        class=\"action-btn confirm-btn\" \r\n        @click=\"handleConfirm\"\r\n      >\r\n        确认收货\r\n      </button>\r\n      <button \r\n        v-if=\"order.status === 'PENDING_PAYMENT'\" \r\n        class=\"action-btn pay-btn\" \r\n        @click=\"handlePay\"\r\n      >\r\n        立即支付\r\n      </button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue'\r\nimport { orderApi } from '@/api/order'\r\nimport { onLoad } from '@dcloudio/uni-app'\r\n\r\nconst order = ref({})\r\nconst orderId = ref(null)\r\n\r\nonLoad(async (options) => {\r\n  orderId.value = options.id\r\n  await loadOrderDetail()\r\n})\r\n\r\nconst loadOrderDetail = async () => {\r\n  try {\r\n    const res = await orderApi.getOrderDetail(orderId.value)\r\n    if (res.code === 200 && res.data) {\r\n      order.value = res.data\r\n    }\r\n  } catch (error) {\r\n    console.error('加载订单详情失败', error)\r\n    uni.showToast({\r\n      title: '加载失败',\r\n      icon: 'none'\r\n    })\r\n  }\r\n}\r\n\r\nconst getStatusText = (status) => {\r\n  const statusMap = {\r\n    'PENDING_PAYMENT': '待支付',\r\n    'PAID': '已支付',\r\n    'PROCESSING': '待发货',\r\n    'SHIPPED': '待收货',\r\n    'COMPLETED': '已完成',\r\n    'CANCELLED': '已取消'\r\n  }\r\n  return statusMap[status] || status\r\n}\r\n\r\nconst getStatusDesc = (status) => {\r\n  const descMap = {\r\n    'PENDING_PAYMENT': '请尽快完成支付',\r\n    'PAID': '订单已支付，等待发货',\r\n    'PROCESSING': '商家正在准备发货',\r\n    'SHIPPED': '商品已发货，请注意查收',\r\n    'COMPLETED': '订单已完成',\r\n    'CANCELLED': '订单已取消'\r\n  }\r\n  return descMap[status] || ''\r\n}\r\n\r\nconst getStatusClass = (status) => {\r\n  const classMap = {\r\n    'PENDING_PAYMENT': 'status-pending',\r\n    'PAID': 'status-paid',\r\n    'PROCESSING': 'status-processing',\r\n    'SHIPPED': 'status-shipped',\r\n    'COMPLETED': 'status-completed',\r\n    'CANCELLED': 'status-cancelled'\r\n  }\r\n  return classMap[status] || ''\r\n}\r\n\r\nconst isStatusReached = (targetStatus) => {\r\n  const statusOrder = ['PENDING_PAYMENT', 'PAID', 'PROCESSING', 'SHIPPED', 'COMPLETED']\r\n  const currentIndex = statusOrder.indexOf(order.value.status)\r\n  const targetIndex = statusOrder.indexOf(targetStatus)\r\n  return currentIndex >= targetIndex\r\n}\r\n\r\nconst handleCancel = () => {\r\n  uni.showModal({\r\n    title: '确认取消',\r\n    content: '确定要取消这个订单吗？',\r\n    success: async (res) => {\r\n      if (res.confirm) {\r\n        try {\r\n          const cancelRes = await orderApi.cancelOrder(orderId.value)\r\n          if (cancelRes.code === 200) {\r\n            uni.showToast({\r\n              title: '取消成功',\r\n              icon: 'success'\r\n            })\r\n            await loadOrderDetail()\r\n          } else {\r\n            uni.showToast({\r\n              title: cancelRes.message || '取消失败',\r\n              icon: 'none'\r\n            })\r\n          }\r\n        } catch (error) {\r\n          uni.showToast({\r\n            title: '取消失败',\r\n            icon: 'none'\r\n          })\r\n        }\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nconst handleConfirm = () => {\r\n  uni.showModal({\r\n    title: '确认收货',\r\n    content: '确认已收到商品？',\r\n    success: async (res) => {\r\n      if (res.confirm) {\r\n        try {\r\n          const confirmRes = await orderApi.confirmReceipt(orderId.value)\r\n          if (confirmRes.code === 200) {\r\n            uni.showToast({\r\n              title: '确认成功',\r\n              icon: 'success'\r\n            })\r\n            await loadOrderDetail()\r\n          } else {\r\n            uni.showToast({\r\n              title: confirmRes.message || '确认失败',\r\n              icon: 'none'\r\n            })\r\n          }\r\n        } catch (error) {\r\n          uni.showToast({\r\n            title: '确认失败',\r\n            icon: 'none'\r\n          })\r\n        }\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nconst handlePay = () => {\r\n  uni.navigateTo({\r\n    url: `/pages/order/payment?orderId=${orderId.value}`\r\n  })\r\n}\r\n\r\nconst formatTime = (timeStr) => {\r\n  if (!timeStr) return ''\r\n  const date = new Date(timeStr)\r\n  return date.toLocaleString('zh-CN')\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.detail-container {\r\n  min-height: 100vh;\r\n  background-color: #F8F8F8;\r\n  padding-bottom: 200rpx;\r\n}\r\n\r\n.status-section {\r\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n  padding: 40rpx;\r\n  color: #ffffff;\r\n  margin-bottom: 20rpx;\r\n  \r\n  .status-info {\r\n    margin-bottom: 30rpx;\r\n    \r\n    .status-text {\r\n      display: block;\r\n      font-size: 48rpx;\r\n      font-weight: bold;\r\n      margin-bottom: 10rpx;\r\n    }\r\n    \r\n    .status-desc {\r\n      display: block;\r\n      font-size: 26rpx;\r\n      opacity: 0.9;\r\n    }\r\n  }\r\n  \r\n  .status-timeline {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    padding-top: 30rpx;\r\n    border-top: 1rpx solid rgba(255, 255, 255, 0.3);\r\n    \r\n    .timeline-item {\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      flex: 1;\r\n      opacity: 0.5;\r\n      \r\n      &.active {\r\n        opacity: 1;\r\n      }\r\n      \r\n      .timeline-dot {\r\n        width: 16rpx;\r\n        height: 16rpx;\r\n        border-radius: 50%;\r\n        background: rgba(255, 255, 255, 0.5);\r\n        margin-bottom: 10rpx;\r\n      }\r\n      \r\n      &.active .timeline-dot {\r\n        background: #ffffff;\r\n        box-shadow: 0 0 10rpx rgba(255, 255, 255, 0.8);\r\n      }\r\n      \r\n      .timeline-text {\r\n        font-size: 22rpx;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.order-info-section,\r\n.items-section,\r\n.amount-section {\r\n  background: #ffffff;\r\n  padding: 30rpx;\r\n  margin-bottom: 20rpx;\r\n  \r\n  .section-title {\r\n    font-size: 32rpx;\r\n    font-weight: bold;\r\n    color: #333333;\r\n    margin-bottom: 20rpx;\r\n  }\r\n  \r\n  .info-item {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    padding: 15rpx 0;\r\n    border-bottom: 1rpx solid #F5F5F5;\r\n    \r\n    &:last-child {\r\n      border-bottom: none;\r\n    }\r\n    \r\n    .info-label {\r\n      font-size: 28rpx;\r\n      color: #666666;\r\n    }\r\n    \r\n    .info-value {\r\n      font-size: 28rpx;\r\n      color: #333333;\r\n    }\r\n  }\r\n}\r\n\r\n.items-section {\r\n  .item-card {\r\n    display: flex;\r\n    padding: 20rpx 0;\r\n    border-bottom: 1rpx solid #F5F5F5;\r\n    \r\n    &:last-child {\r\n      border-bottom: none;\r\n    }\r\n    \r\n    .item-image {\r\n      width: 120rpx;\r\n      height: 120rpx;\r\n      border-radius: 10rpx;\r\n      margin-right: 20rpx;\r\n    }\r\n    \r\n    .item-info {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-direction: column;\r\n      justify-content: space-between;\r\n      \r\n      .item-spec {\r\n        font-size: 28rpx;\r\n        color: #333333;\r\n        margin-bottom: 10rpx;\r\n      }\r\n      \r\n      .item-quantity {\r\n        font-size: 24rpx;\r\n        color: #999999;\r\n        margin-bottom: 10rpx;\r\n      }\r\n      \r\n      .item-price {\r\n        font-size: 32rpx;\r\n        font-weight: bold;\r\n        color: #FF3B30;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.amount-section {\r\n  .amount-item {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    padding: 15rpx 0;\r\n    \r\n    .amount-label {\r\n      font-size: 28rpx;\r\n      color: #666666;\r\n    }\r\n    \r\n    .amount-value {\r\n      font-size: 28rpx;\r\n      color: #333333;\r\n    }\r\n  }\r\n  \r\n  .amount-total {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    padding: 20rpx 0;\r\n    margin-top: 20rpx;\r\n    border-top: 1rpx solid #E5E5E5;\r\n    \r\n    .total-label {\r\n      font-size: 32rpx;\r\n      font-weight: bold;\r\n      color: #333333;\r\n    }\r\n    \r\n    .total-value {\r\n      font-size: 36rpx;\r\n      font-weight: bold;\r\n      color: #FF3B30;\r\n    }\r\n  }\r\n}\r\n\r\n.action-section {\r\n  position: fixed;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  padding: 30rpx 40rpx;\r\n  background: #ffffff;\r\n  box-shadow: 0 -4rpx 20rpx rgba(0, 0, 0, 0.1);\r\n  display: flex;\r\n  gap: 20rpx;\r\n  \r\n  .action-btn {\r\n    flex: 1;\r\n    height: 88rpx;\r\n    border-radius: 44rpx;\r\n    font-size: 32rpx;\r\n    font-weight: bold;\r\n    border: none;\r\n    \r\n    &.cancel-btn {\r\n      background: #F5F5F5;\r\n      color: #666666;\r\n    }\r\n    \r\n    &.confirm-btn {\r\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n      color: #ffffff;\r\n    }\r\n    \r\n    &.pay-btn {\r\n      background: linear-gradient(135deg, #FF9500 0%, #FF6B00 100%);\r\n      color: #ffffff;\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n","import MiniProgramPage from 'D:/code/my-shop-cursor/frontend/pages/order/detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onLoad","orderApi","uni"],"mappings":";;;;;;AAkHA,UAAM,QAAQA,cAAG,IAAC,EAAE;AACpB,UAAM,UAAUA,cAAG,IAAC,IAAI;AAExBC,kBAAM,OAAC,OAAO,YAAY;AACxB,cAAQ,QAAQ,QAAQ;AACxB,YAAM,gBAAiB;AAAA,IACzB,CAAC;AAED,UAAM,kBAAkB,YAAY;AAClC,UAAI;AACF,cAAM,MAAM,MAAMC,UAAAA,SAAS,eAAe,QAAQ,KAAK;AACvD,YAAI,IAAI,SAAS,OAAO,IAAI,MAAM;AAChC,gBAAM,QAAQ,IAAI;AAAA,QACnB;AAAA,MACF,SAAQ,OAAO;AACdC,sBAAAA,MAAA,MAAA,SAAA,iCAAc,YAAY,KAAK;AAC/BA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACF;AAAA,IACH;AAEA,UAAM,gBAAgB,CAAC,WAAW;AAChC,YAAM,YAAY;AAAA,QAChB,mBAAmB;AAAA,QACnB,QAAQ;AAAA,QACR,cAAc;AAAA,QACd,WAAW;AAAA,QACX,aAAa;AAAA,QACb,aAAa;AAAA,MACd;AACD,aAAO,UAAU,MAAM,KAAK;AAAA,IAC9B;AAEA,UAAM,gBAAgB,CAAC,WAAW;AAChC,YAAM,UAAU;AAAA,QACd,mBAAmB;AAAA,QACnB,QAAQ;AAAA,QACR,cAAc;AAAA,QACd,WAAW;AAAA,QACX,aAAa;AAAA,QACb,aAAa;AAAA,MACd;AACD,aAAO,QAAQ,MAAM,KAAK;AAAA,IAC5B;AAEA,UAAM,iBAAiB,CAAC,WAAW;AACjC,YAAM,WAAW;AAAA,QACf,mBAAmB;AAAA,QACnB,QAAQ;AAAA,QACR,cAAc;AAAA,QACd,WAAW;AAAA,QACX,aAAa;AAAA,QACb,aAAa;AAAA,MACd;AACD,aAAO,SAAS,MAAM,KAAK;AAAA,IAC7B;AAEA,UAAM,kBAAkB,CAAC,iBAAiB;AACxC,YAAM,cAAc,CAAC,mBAAmB,QAAQ,cAAc,WAAW,WAAW;AACpF,YAAM,eAAe,YAAY,QAAQ,MAAM,MAAM,MAAM;AAC3D,YAAM,cAAc,YAAY,QAAQ,YAAY;AACpD,aAAO,gBAAgB;AAAA,IACzB;AAEA,UAAM,eAAe,MAAM;AACzBA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,OAAO,QAAQ;AACtB,cAAI,IAAI,SAAS;AACf,gBAAI;AACF,oBAAM,YAAY,MAAMD,UAAAA,SAAS,YAAY,QAAQ,KAAK;AAC1D,kBAAI,UAAU,SAAS,KAAK;AAC1BC,8BAAAA,MAAI,UAAU;AAAA,kBACZ,OAAO;AAAA,kBACP,MAAM;AAAA,gBACpB,CAAa;AACD,sBAAM,gBAAiB;AAAA,cACnC,OAAiB;AACLA,8BAAAA,MAAI,UAAU;AAAA,kBACZ,OAAO,UAAU,WAAW;AAAA,kBAC5B,MAAM;AAAA,gBACpB,CAAa;AAAA,cACF;AAAA,YACF,SAAQ,OAAO;AACdA,4BAAAA,MAAI,UAAU;AAAA,gBACZ,OAAO;AAAA,gBACP,MAAM;AAAA,cAClB,CAAW;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;AAEA,UAAM,gBAAgB,MAAM;AAC1BA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,OAAO,QAAQ;AACtB,cAAI,IAAI,SAAS;AACf,gBAAI;AACF,oBAAM,aAAa,MAAMD,UAAAA,SAAS,eAAe,QAAQ,KAAK;AAC9D,kBAAI,WAAW,SAAS,KAAK;AAC3BC,8BAAAA,MAAI,UAAU;AAAA,kBACZ,OAAO;AAAA,kBACP,MAAM;AAAA,gBACpB,CAAa;AACD,sBAAM,gBAAiB;AAAA,cACnC,OAAiB;AACLA,8BAAAA,MAAI,UAAU;AAAA,kBACZ,OAAO,WAAW,WAAW;AAAA,kBAC7B,MAAM;AAAA,gBACpB,CAAa;AAAA,cACF;AAAA,YACF,SAAQ,OAAO;AACdA,4BAAAA,MAAI,UAAU;AAAA,gBACZ,OAAO;AAAA,gBACP,MAAM;AAAA,cAClB,CAAW;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;AAEA,UAAM,YAAY,MAAM;AACtBA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,gCAAgC,QAAQ,KAAK;AAAA,MACtD,CAAG;AAAA,IACH;AAEA,UAAM,aAAa,CAAC,YAAY;AAC9B,UAAI,CAAC;AAAS,eAAO;AACrB,YAAM,OAAO,IAAI,KAAK,OAAO;AAC7B,aAAO,KAAK,eAAe,OAAO;AAAA,IACpC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3PA,GAAG,WAAW,eAAe;"}