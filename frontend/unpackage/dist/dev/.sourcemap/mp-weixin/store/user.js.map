{"version":3,"file":"user.js","sources":["store/user.js"],"sourcesContent":["import { defineStore } from 'pinia'\r\nimport { authApi } from '@/api/auth'\r\n\r\nexport const useUserStore = defineStore('user', {\r\n  state: () => ({\r\n    user: null,\r\n    token: uni.getStorageSync('token') || null\r\n  }),\r\n  \r\n  actions: {\r\n    async login(code) {\r\n      try {\r\n        const res = await authApi.login(code)\r\n        if (res.code === 200) {\r\n          this.token = res.data.token\r\n          this.user = res.data.user\r\n          uni.setStorageSync('token', this.token)\r\n          return true\r\n        }\r\n        return false\r\n      } catch (error) {\r\n        console.error('登录失败', error)\r\n        return false\r\n      }\r\n    },\r\n    \r\n    logout() {\r\n      this.user = null\r\n      this.token = null\r\n      uni.removeStorageSync('token')\r\n    }\r\n  }\r\n})\r\n\r\n\r\n"],"names":["defineStore","uni","authApi"],"mappings":";;;AAGY,MAAC,eAAeA,cAAW,YAAC,QAAQ;AAAA,EAC9C,OAAO,OAAO;AAAA,IACZ,MAAM;AAAA,IACN,OAAOC,cAAG,MAAC,eAAe,OAAO,KAAK;AAAA,EAC1C;AAAA,EAEE,SAAS;AAAA,IACP,MAAM,MAAM,MAAM;AAChB,UAAI;AACF,cAAM,MAAM,MAAMC,iBAAQ,MAAM,IAAI;AACpC,YAAI,IAAI,SAAS,KAAK;AACpB,eAAK,QAAQ,IAAI,KAAK;AACtB,eAAK,OAAO,IAAI,KAAK;AACrBD,wBAAAA,MAAI,eAAe,SAAS,KAAK,KAAK;AACtC,iBAAO;AAAA,QACR;AACD,eAAO;AAAA,MACR,SAAQ,OAAO;AACdA,sBAAAA,MAAc,MAAA,SAAA,uBAAA,QAAQ,KAAK;AAC3B,eAAO;AAAA,MACR;AAAA,IACF;AAAA,IAED,SAAS;AACP,WAAK,OAAO;AACZ,WAAK,QAAQ;AACbA,oBAAG,MAAC,kBAAkB,OAAO;AAAA,IAC9B;AAAA,EACF;AACH,CAAC;;"}