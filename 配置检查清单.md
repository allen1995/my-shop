# 配置检查清单

在启动项目前，请按照以下清单逐一检查配置。

## 🔴 必须配置（否则项目无法运行）

### 后端配置

- [ ] **JWT_SECRET** - JWT密钥
  - 位置：`backend/src/main/resources/application.yml` 或环境变量
  - 要求：至少32位随机字符串
  - 示例：`MyJwtSecretKey2024!@#$%^&*()_+`

- [ ] **WECHAT_APP_ID** - 微信小程序AppID
  - 位置：`backend/src/main/resources/application.yml` 或环境变量
  - 获取：微信公众平台 -> 开发 -> 开发设置
  - 格式：`wx1234567890abcdef`

- [ ] **WECHAT_APP_SECRET** - 微信小程序AppSecret
  - 位置：`backend/src/main/resources/application.yml` 或环境变量
  - 获取：微信公众平台 -> 开发 -> 开发设置
  - ⚠️ 注意：不要泄露

- [ ] **ALIYUN_OSS_ENDPOINT** - 阿里云OSS端点
  - 位置：`backend/src/main/resources/application.yml` 或环境变量
  - 示例：`oss-cn-hangzhou.aliyuncs.com`
  - 获取：阿里云OSS控制台

- [ ] **ALIYUN_OSS_ACCESS_KEY_ID** - OSS访问密钥ID
  - 位置：`backend/src/main/resources/application.yml` 或环境变量
  - 获取：阿里云控制台 -> 访问控制 -> 用户

- [ ] **ALIYUN_OSS_ACCESS_KEY_SECRET** - OSS访问密钥
  - 位置：`backend/src/main/resources/application.yml` 或环境变量
  - ⚠️ 注意：不要泄露

- [ ] **ALIYUN_OSS_BUCKET_NAME** - OSS存储桶名称
  - 位置：`backend/src/main/resources/application.yml` 或环境变量
  - 要求：先创建Bucket

- [ ] **ALIYUN_DASHSCOPE_API_KEY** - 阿里云百炼API密钥
  - 位置：`backend/src/main/resources/application.yml` 或环境变量
  - 获取：阿里云百炼控制台 -> API-KEY管理
  - 格式：`sk-...`

### 前端配置

- [ ] **BASE_URL** - 后端API地址
  - 位置：`frontend/src/utils/request.js`
  - 开发环境：`http://localhost:8080/api`
  - 生产环境：`https://api.yourdomain.com/api`
  - ⚠️ 注意：微信小程序生产环境必须使用HTTPS

- [ ] **小程序AppID** - 微信小程序ID
  - 位置：`frontend/manifest.json` -> `mp-weixin.appid`
  - 必须与后端 `WECHAT_APP_ID` 一致

## 🟡 可选配置（功能需要时配置）

### 微信支付配置（如果使用支付功能）

- [ ] **WECHAT_PAY_APP_ID** - 微信支付AppID
- [ ] **WECHAT_PAY_MCH_ID** - 商户号
- [ ] **WECHAT_PAY_API_V3_KEY** - API v3密钥
- [ ] **WECHAT_PAY_CERT_PATH** - 证书路径

### 数据库配置（生产环境）

- [ ] 如果使用MySQL，修改 `application.yml` 中的数据库配置
- [ ] 配置数据库连接池参数

## 🟢 可选优化配置

- [ ] 修改服务器端口（如果8080被占用）
- [ ] 配置日志级别
- [ ] 配置CORS跨域（如果需要）
- [ ] 配置CDN加速（OSS）

## 📋 配置步骤

### 步骤1：创建环境变量文件

在 `backend/` 目录创建 `.env` 文件（不要提交到Git）：

```bash
JWT_SECRET=your-secret-key-here
WECHAT_APP_ID=wx1234567890abcdef
WECHAT_APP_SECRET=your-app-secret-here
ALIYUN_OSS_ENDPOINT=oss-cn-hangzhou.aliyuncs.com
ALIYUN_OSS_ACCESS_KEY_ID=your-access-key-id
ALIYUN_OSS_ACCESS_KEY_SECRET=your-access-key-secret
ALIYUN_OSS_BUCKET_NAME=your-bucket-name
ALIYUN_DASHSCOPE_API_KEY=sk-your-api-key
```

### 步骤2：修改前端配置

1. 打开 `frontend/src/utils/request.js`
2. 修改 `BASE_URL` 为实际后端地址

### 步骤3：配置微信小程序

1. 打开 `frontend/manifest.json`
2. 填写 `mp-weixin.appid`

### 步骤4：配置微信小程序服务器域名

1. 登录微信公众平台
2. 开发 -> 开发管理 -> 开发设置
3. 配置服务器域名：
   - request合法域名：你的后端API地址
   - uploadFile合法域名：OSS域名
   - downloadFile合法域名：OSS域名

## ✅ 验证配置

### 后端验证

1. 启动后端服务：
   ```bash
   cd backend
   mvn spring-boot:run
   ```

2. 访问健康检查：
   ```
   http://localhost:8080/api/health
   ```
   应该返回：`{"status":"UP","timestamp":...}`

3. 检查日志，确认没有配置错误

### 前端验证

1. 在微信开发者工具中打开项目
2. 检查控制台是否有API连接错误
3. 尝试登录功能

## 🚨 常见错误

### 错误1：后端启动失败
- **原因**：环境变量未设置或配置错误
- **解决**：检查环境变量，查看启动日志

### 错误2：前端无法连接后端
- **原因**：BASE_URL配置错误或后端未启动
- **解决**：检查BASE_URL，确认后端服务运行

### 错误3：微信登录失败
- **原因**：AppID或AppSecret错误
- **解决**：检查微信配置，查看后端日志

### 错误4：OSS上传失败
- **原因**：OSS配置错误或权限不足
- **解决**：检查OSS配置，确认Bucket存在

### 错误5：AI生成失败
- **原因**：百炼API Key错误或余额不足
- **解决**：检查API Key，确认账户余额

## 📝 配置完成后

- [ ] 所有必须配置项已填写
- [ ] 后端服务可以正常启动
- [ ] 前端可以正常连接后端
- [ ] 微信登录功能正常
- [ ] OSS上传功能正常
- [ ] AI生成功能正常

---

**提示**：详细配置说明请查看 `docs/配置说明.md`

